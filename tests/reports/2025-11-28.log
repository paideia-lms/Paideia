bun test v1.3.1 (89fa0f34)

app/utils/fill-in-the-blank-utils.test.ts:
(pass) fill-in-the-blank-utils > isValidBlankId > should accept valid snake_case IDs [1.59ms]
(pass) fill-in-the-blank-utils > isValidBlankId > should accept valid CONSTANT_CASE IDs [0.13ms]
(pass) fill-in-the-blank-utils > isValidBlankId > should reject invalid IDs [0.11ms]
(pass) fill-in-the-blank-utils > parseFillInTheBlank > should parse simple single blank [1.32ms]
(pass) fill-in-the-blank-utils > parseFillInTheBlank > should parse multiple different blanks [0.08ms]
(pass) fill-in-the-blank-utils > parseFillInTheBlank > should handle repeated blank IDs [0.03ms]
(pass) fill-in-the-blank-utils > parseFillInTheBlank > should detect invalid blank IDs [0.03ms]
(pass) fill-in-the-blank-utils > parseFillInTheBlank > should handle mix of valid and invalid IDs [0.02ms]
(pass) fill-in-the-blank-utils > parseFillInTheBlank > should handle prompts with no blanks [0.02ms]
(pass) fill-in-the-blank-utils > parseFillInTheBlank > should handle empty prompt [0.03ms]
(pass) fill-in-the-blank-utils > parseFillInTheBlank > should trim spaces around blank IDs [0.23ms]
(pass) fill-in-the-blank-utils > parseFillInTheBlank > should treat blanks with spaces as same ID after trimming [0.05ms]
(pass) fill-in-the-blank-utils > splitPromptIntoParts > should split prompt with single blank [0.74ms]
(pass) fill-in-the-blank-utils > splitPromptIntoParts > should split prompt with multiple blanks [0.04ms]
(pass) fill-in-the-blank-utils > splitPromptIntoParts > should handle prompt starting with blank [0.01ms]
(pass) fill-in-the-blank-utils > splitPromptIntoParts > should handle prompt ending with blank [0.01ms]
(pass) fill-in-the-blank-utils > splitPromptIntoParts > should handle consecutive blanks
(pass) fill-in-the-blank-utils > splitPromptIntoParts > should handle prompt with no blanks [0.02ms]
(pass) fill-in-the-blank-utils > splitPromptIntoParts > should handle empty prompt [0.02ms]
(pass) fill-in-the-blank-utils > splitPromptIntoParts > should handle repeated blank IDs [0.02ms]
(pass) fill-in-the-blank-utils > splitPromptIntoParts > should trim spaces around blank IDs [0.02ms]
(pass) fill-in-the-blank-utils > splitPromptIntoParts > should treat blanks with spaces as same ID after trimming [0.02ms]

app/components/course-structure-tree.test.ts:
(pass) calculateMoveOperation > should return null for multiple item moves [1.54ms]
(pass) calculateMoveOperation > should handle moving section into another section [0.05ms]
(pass) calculateMoveOperation > should handle moving module above another module [0.01ms]
(pass) calculateMoveOperation > should handle moving to end of children list [0.03ms]

server/internal/activity-module-access.test.ts:
(pass) Activity Module Access Control > should create activity module with owner field [21.34ms]
(pass) Activity Module Access Control > should allow owner to read their activity module [21.86ms]
(pass) Activity Module Access Control > should allow owner to update their activity module [29.28ms]
(pass) Activity Module Access Control > should allow owner to delete their activity module [24.27ms]
(pass) Activity Module Access Control > should not allow non-owner to read activity module [17.80ms]
(pass) Activity Module Access Control > should grant access to another user [40.33ms]
(pass) Activity Module Access Control > should allow granted user to read activity module [38.36ms]
(pass) Activity Module Access Control > should allow granted user to update activity module [48.52ms]
(pass) Activity Module Access Control > should not allow granted user to delete activity module [40.87ms]
(pass) Activity Module Access Control > should revoke access from user [56.68ms]
(pass) Activity Module Access Control > should grant access to previous owner after ownership transfer [80.21ms]
(pass) Activity Module Access Control > should check access for owner [18.41ms]
(pass) Activity Module Access Control > should check access for granted user [27.90ms]
(pass) Activity Module Access Control > should check access for non-granted user [16.57ms]
(pass) Activity Module Access Control > should check access for admin [14.86ms]
(pass) Activity Module Access Control > should allow admin to access any activity module [37.85ms]
(pass) Activity Module Access Control > should prevent duplicate access grants [28.40ms]
(pass) Activity Module Access Control > should prevent owner from being granted access again [22.17ms]
(pass) Activity Module Access Control > should handle ownership transfer removing new owner's grant [68.71ms]
(pass) Activity Module Access Control > should find grants for activity module [37.17ms]
(pass) Activity Module Access Control > should find instructors for activity module [168.76ms]
(pass) Activity Module Access Control > should find instructors from multiple linked courses [239.42ms]
(pass) Activity Module Access Control > should return empty array when no instructors found [16.30ms]
(pass) Activity Module Access Control > should return empty array when no grants found [11.08ms]
(pass) Activity Module Access Control > should find auto granted modules for instructor [255.82ms]
(pass) Activity Module Access Control > should find auto granted modules for TA [241.56ms]
(pass) Activity Module Access Control > should find multiple auto granted modules from multiple courses [170.75ms]
(pass) Activity Module Access Control > should not find auto granted modules for inactive enrollment [93.49ms]
(pass) Activity Module Access Control > should not find auto granted modules for student enrollment [92.76ms]
(pass) Activity Module Access Control > should return empty array when user has no enrollments [15.48ms]
(pass) Activity Module Access Control > should return empty array when no activity modules linked to courses [35.26ms]

server/internal/category-role-management.test.ts:
(pass) Category Role Management Functions > should assign category role to user [20.76ms]
(pass) Category Role Management Functions > should revoke category role from user [28.57ms]
(pass) Category Role Management Functions > should update existing role assignment [29.34ms]
 7 |             isReadingStaticFile,
 8 |             req
 9 |         });
10 |         if (!resolvedConstraint) {
11 |             if (!disableErrors) {
12 |                 throw new Forbidden(req.t);
                               ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/auth/executeAccess.js:12:27
      at processTicksAndRejections (native:7:39)

249 | 		// Verify only one assignment exists
250 | 		const assignments = await tryGetCategoryRoleAssignments({
251 | 			payload,
252 | 			categoryId: categoryResult.value.id,
253 | 		});
254 | 		expect(assignments.ok).toBe(true);
                               ^
error: expect(received).toBe(expected)

Expected: true
Received: false

      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/category-role-management.test.ts:254:26)
(fail) Category Role Management Functions > should prevent duplicate assignments (one role per user per category) [40.14ms]
 7 |             isReadingStaticFile,
 8 |             req
 9 |         });
10 |         if (!resolvedConstraint) {
11 |             if (!disableErrors) {
12 |                 throw new Forbidden(req.t);
                               ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/auth/executeAccess.js:12:27
      at processTicksAndRejections (native:7:39)

300 | 		const userRoles = await tryGetUserCategoryRoles({
301 | 			payload,
302 | 			userId: user2.id,
303 | 		});
304 | 
305 | 		expect(userRoles.ok).toBe(true);
                             ^
error: expect(received).toBe(expected)

Expected: true
Received: false

      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/category-role-management.test.ts:305:24)
(fail) Category Role Management Functions > should get all role assignments for a user [35.03ms]
 7 |             isReadingStaticFile,
 8 |             req
 9 |         });
10 |         if (!resolvedConstraint) {
11 |             if (!disableErrors) {
12 |                 throw new Forbidden(req.t);
                               ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/auth/executeAccess.js:12:27
      at processTicksAndRejections (native:7:39)

341 | 		const assignments = await tryGetCategoryRoleAssignments({
342 | 			payload,
343 | 			categoryId: categoryResult.value.id,
344 | 		});
345 | 
346 | 		expect(assignments.ok).toBe(true);
                               ^
error: expect(received).toBe(expected)

Expected: true
Received: false

      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/category-role-management.test.ts:346:26)
(fail) Category Role Management Functions > should get all role assignments for a category [26.34ms]
 7 |             isReadingStaticFile,
 8 |             req
 9 |         });
10 |         if (!resolvedConstraint) {
11 |             if (!disableErrors) {
12 |                 throw new Forbidden(req.t);
                               ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/auth/executeAccess.js:12:27
      at processTicksAndRejections (native:7:39)

373 | 			payload,
374 | 			userId: user1.id,
375 | 			categoryId: categoryResult.value.id,
376 | 		});
377 | 
378 | 		expect(found.ok).toBe(true);
                         ^
error: expect(received).toBe(expected)

Expected: true
Received: false

      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/category-role-management.test.ts:378:20)
(fail) Category Role Management Functions > should find specific role assignment [19.89ms]
 7 |             isReadingStaticFile,
 8 |             req
 9 |         });
10 |         if (!resolvedConstraint) {
11 |             if (!disableErrors) {
12 |                 throw new Forbidden(req.t);
                               ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/auth/executeAccess.js:12:27
      at processTicksAndRejections (native:7:39)

407 | 			categoryId: categoryResult.value.id,
408 | 		});
409 | 
410 | 		expect(checkResult.ok).toBe(true);
411 | 		if (checkResult.ok) {
412 | 			expect(checkResult.value).toBe("category-admin");
                                   ^
error: expect(received).toBe(expected)

Expected: "category-admin"
Received: null

      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/category-role-management.test.ts:412:30)
(fail) Category Role Management Functions > should check if user has role on category [20.54ms]
 7 |             isReadingStaticFile,
 8 |             req
 9 |         });
10 |         if (!resolvedConstraint) {
11 |             if (!disableErrors) {
12 |                 throw new Forbidden(req.t);
                               ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/auth/executeAccess.js:12:27
      at processTicksAndRejections (native:7:39)

449 | 			payload,
450 | 			userId: user1.id,
451 | 			categoryId: childCat.value.id,
452 | 		});
453 | 
454 | 		expect(effectiveRole.ok).toBe(true);
                                 ^
error: expect(received).toBe(expected)

Expected: true
Received: false

      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/category-role-management.test.ts:454:28)
(fail) Category Role Management Functions > should get effective role with inheritance from parent category [23.64ms]
 7 |             isReadingStaticFile,
 8 |             req
 9 |         });
10 |         if (!resolvedConstraint) {
11 |             if (!disableErrors) {
12 |                 throw new Forbidden(req.t);
                               ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/auth/executeAccess.js:12:27
      at processTicksAndRejections (native:7:39)

514 | 			payload,
515 | 			userId: user1.id,
516 | 			categoryId: child.value.id,
517 | 		});
518 | 
519 | 		expect(effectiveRole.ok).toBe(true);
                                 ^
error: expect(received).toBe(expected)

Expected: true
Received: false

      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/category-role-management.test.ts:519:28)
(fail) Category Role Management Functions > should respect role priority (admin > coordinator > reviewer) [38.08ms]
 7 |             isReadingStaticFile,
 8 |             req
 9 |         });
10 |         if (!resolvedConstraint) {
11 |             if (!disableErrors) {
12 |                 throw new Forbidden(req.t);
                               ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/auth/executeAccess.js:12:27
      at processTicksAndRejections (native:7:39)

581 | 		const userCourses = await tryGetUserCoursesFromCategories({
582 | 			payload,
583 | 			userId: user1.id,
584 | 		});
585 | 
586 | 		expect(userCourses.ok).toBe(true);
                               ^
error: expect(received).toBe(expected)

Expected: true
Received: false

      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/category-role-management.test.ts:586:26)
(fail) Category Role Management Functions > should get all courses user can access via category roles [66.05ms]
 7 |             isReadingStaticFile,
 8 |             req
 9 |         });
10 |         if (!resolvedConstraint) {
11 |             if (!disableErrors) {
12 |                 throw new Forbidden(req.t);
                               ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/auth/executeAccess.js:12:27
      at processTicksAndRejections (native:7:39)

629 | 			courseId: course.value.id,
630 | 		});
631 | 
632 | 		expect(access.ok).toBe(true);
633 | 		if (access.ok) {
634 | 			expect(access.value).toBe("category-admin");
                              ^
error: expect(received).toBe(expected)

Expected: "category-admin"
Received: null

      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/category-role-management.test.ts:634:25)
(fail) Category Role Management Functions > should check course access via direct category [49.29ms]
 7 |             isReadingStaticFile,
 8 |             req
 9 |         });
10 |         if (!resolvedConstraint) {
11 |             if (!disableErrors) {
12 |                 throw new Forbidden(req.t);
                               ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/auth/executeAccess.js:12:27
      at processTicksAndRejections (native:7:39)

686 | 			courseId: course.value.id,
687 | 		});
688 | 
689 | 		expect(access.ok).toBe(true);
690 | 		if (access.ok) {
691 | 			expect(access.value).toBe("category-coordinator");
                              ^
error: expect(received).toBe(expected)

Expected: "category-coordinator"
Received: null

      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/category-role-management.test.ts:691:25)
(fail) Category Role Management Functions > should check course access via ancestor category [43.20ms]

server/internal/assignment-submission-management.test.ts:
(pass) Assignment Submission Management - Full Workflow > should create assignment submission (student workflow) [40.72ms]
(pass) Assignment Submission Management - Full Workflow > should update assignment submission (student editing draft) [99.75ms]
(pass) Assignment Submission Management - Full Workflow > should submit assignment (student submits for grading) [82.65ms]
(pass) Assignment Submission Management - Full Workflow > should grade assignment submission (teacher grades student work) [135.98ms]
(pass) Assignment Submission Management - Full Workflow > should get assignment submission by ID [73.24ms]
(pass) Assignment Submission Management - Full Workflow > should list assignment submissions with filtering [76.61ms]
(pass) Assignment Submission Management - Full Workflow > should handle late submissions [52.81ms]
(pass) Assignment Submission Management - Full Workflow > should prevent duplicate submissions for same attempt [66.00ms]
(pass) Assignment Submission Management - Full Workflow > should validate grade limits [103.64ms]
(pass) Assignment Submission Management - Full Workflow > should only allow grading of submitted assignments [45.49ms]
(pass) Assignment Submission Management - Full Workflow > should delete assignment submission [73.65ms]
(pass) Assignment Submission Management - Full Workflow > should handle pagination in listing [301.59ms]
(pass) Assignment Submission Management - Full Workflow > should fail with invalid arguments [0.40ms]
(pass) Assignment Submission Management - Full Workflow > should fail to get non-existent submission [2.88ms]
 96 |             throw new NotFound(t);
 97 |         }
 98 |         const docFromDB = await req.payload.db.findOne(findOneArgs);
 99 |         if (!docFromDB && !args.data) {
100 |             if (!disableErrors) {
101 |                 throw new NotFound(req.t);
                                ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/findByID.js:101:27
      at processTicksAndRejections (native:7:39)

(pass) Assignment Submission Management - Full Workflow > should fail to update non-existent submission [5.15ms]
73 |             locale: req.locale,
74 |             req,
75 |             where
76 |         });
77 |         if (!docToDelete && !hasWhereAccess) {
78 |             throw new NotFound(req.t);
                           ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/deleteByID.js:78:23
      at processTicksAndRejections (native:7:39)

(pass) Assignment Submission Management - Full Workflow > should fail to delete non-existent submission [3.78ms]

server/internal/quiz-submission-management-prevent-duplicate-attempts.test.ts:
 7 |             isReadingStaticFile,
 8 |             req
 9 |         });
10 |         if (!resolvedConstraint) {
11 |             if (!disableErrors) {
12 |                 throw new Forbidden(req.t);
                               ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/auth/executeAccess.js:12:27
      at processTicksAndRejections (native:7:39)

179 | 			order: 0,
180 | 		};
181 | 
182 | 		const linkResult = await tryCreateCourseActivityModuleLink(linkArgs);
183 | 		if (!linkResult.ok) {
184 | 			throw new Error(
                   ^
error: Test Error: Failed to create course-activity-module-link
      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/quiz-submission-management-prevent-duplicate-attempts.test.ts:184:14)
(fail) Quiz Attempt Management - Prevent Duplicate Attempts > (unnamed) [2272.91ms]

server/internal/auth.test.ts:
(pass) Authentication Functions > First User Registration and Authentication Flow > should check that no users exist initially [10.78ms]
(pass) Authentication Functions > First User Registration and Authentication Flow > should create and auto-login first user [106.30ms]
(pass) Authentication Functions > First User Registration and Authentication Flow > should verify first user check returns false after user creation [2.64ms]
(pass) Authentication Functions > Manual Login Flow > should login with correct credentials [47.24ms]
(pass) Authentication Functions > Manual Login Flow > should fail login with incorrect credentials [41.87ms]
(pass) Authentication Functions > Manual Login Flow > should fail login with non-existent user [2.68ms]
(pass) Authentication Functions > Authentication and Profile Access > should login and get authentication token [49.62ms]
(pass) Authentication Functions > Authentication and Profile Access > should authenticate user with token and get profile [2.35ms]
(pass) Authentication Functions > Authentication and Profile Access > should get user profile by ID when authenticated [1.96ms]
(pass) Authentication Functions > Authentication and Profile Access > should fail authentication with invalid token [0.65ms]
(pass) Authentication Functions > Authentication and Profile Access > should fail authentication with no token [0.23ms]
(pass) Authentication Functions > Cookie-based Authentication Simulation > should simulate cookie-based authentication flow [48.01ms]
(pass) Authentication Functions > Cookie-based Authentication Simulation > should simulate logout by invalidating token access [0.40ms]
(pass) Authentication Functions > Multiple User Authentication > should create a second user and test separate authentication [84.66ms]

server/internal/search-management.test.ts:
(pass) parseQuery > should parse query [0.40ms]
(pass) parseQuery > should parse query with in [0.68ms]
(pass) parseQuery > should parse query with multiple in [0.39ms]
(pass) Search Management Functions > tryGlobalSearch > should return courses and users [11.46ms]
(pass) Search Management Functions > tryGlobalSearch > should users by name [24.35ms]
(pass) Search Management Functions > tryGlobalSearch > should search users by in [33.29ms]
(pass) Search Management Functions > tryGlobalSearch > should search courses by in [16.72ms]
(pass) Search Management Functions > tryGlobalSearch > should search courses by name [27.04ms]
(pass) Search Management Functions > Search Collection Sync on Deletion > should remove course from search when course is deleted [1217.67ms]
(pass) Search Management Functions > Search Collection Sync on Deletion > should remove user from search when user is deleted [1084.00ms]
(pass) Search Management Functions > Search Collection Sync on Deletion > should update search when course is updated [1586.68ms]

server/internal/gradebook-category-management.test.ts:
(pass) Gradebook Category Management > should create a gradebook category [13.16ms]
(pass) Gradebook Category Management > should not create category with invalid sort order [0.24ms]
(pass) Gradebook Category Management > should create a subcategory [22.22ms]
(pass) Gradebook Category Management > should persist nested category after creation [156.39ms]
(pass) Gradebook Category Management > should find gradebook category by ID [6.09ms]
(pass) Gradebook Category Management > should update gradebook category [29.65ms]
(pass) Gradebook Category Management > should get gradebook categories hierarchy [12.03ms]
(pass) Gradebook Category Management > should get next sort order [9.46ms]
(pass) Gradebook Category Management > should reorder categories [12.96ms]
(pass) Gradebook Category Management > should delete gradebook category [28.22ms]
 96 |             throw new NotFound(t);
 97 |         }
 98 |         const docFromDB = await req.payload.db.findOne(findOneArgs);
 99 |         if (!docFromDB && !args.data) {
100 |             if (!disableErrors) {
101 |                 throw new NotFound(req.t);
                                ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/findByID.js:101:27
      at processTicksAndRejections (native:7:39)

(pass) Gradebook Category Management > should not find deleted category [3.08ms]

server/internal/file-management.test.ts:
(pass) File Management Functions > should create a file with valid media [12.02ms]
(pass) File Management Functions > should create a file with empty media array [8.93ms]
(pass) File Management Functions > should create a file without media [8.71ms]
(pass) File Management Functions > should fail to create a file without userId [0.25ms]
(pass) File Management Functions > should get a file by ID [14.13ms]
 96 |             throw new NotFound(t);
 97 |         }
 98 |         const docFromDB = await req.payload.db.findOne(findOneArgs);
 99 |         if (!docFromDB && !args.data) {
100 |             if (!disableErrors) {
101 |                 throw new NotFound(req.t);
                                ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/findByID.js:101:27
      at processTicksAndRejections (native:7:39)

(pass) File Management Functions > should fail to get a non-existent file [1.57ms]
245 | 			if (updateResult.ok) {
246 | 				expect(updateResult.value.media).toBeDefined();
247 | 				if (Array.isArray(updateResult.value.media)) {
248 | 					expect(updateResult.value.media.length).toBe(1);
249 | 					const mediaId = updateResult.value.media[0];
250 | 					expect(mediaId).toBe(testMediaId2);
                           ^
error: expect(received).toBe(expected)

Expected: 2
Received: {

      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/file-management.test.ts:250:22)
(fail) File Management Functions > should update a file media [32.10ms]
(pass) File Management Functions > should update a file to have no media [29.80ms]
 96 |             throw new NotFound(t);
 97 |         }
 98 |         const docFromDB = await req.payload.db.findOne(findOneArgs);
 99 |         if (!docFromDB && !args.data) {
100 |             if (!disableErrors) {
101 |                 throw new NotFound(req.t);
                                ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/findByID.js:101:27
      at processTicksAndRejections (native:7:39)

(pass) File Management Functions > should fail to update a non-existent file [1.95ms]
 96 |             throw new NotFound(t);
 97 |         }
 98 |         const docFromDB = await req.payload.db.findOne(findOneArgs);
 99 |         if (!docFromDB && !args.data) {
100 |             if (!disableErrors) {
101 |                 throw new NotFound(req.t);
                                ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/findByID.js:101:27
      at processTicksAndRejections (native:7:39)

(pass) File Management Functions > should delete a file [37.32ms]
 96 |             throw new NotFound(t);
 97 |         }
 98 |         const docFromDB = await req.payload.db.findOne(findOneArgs);
 99 |         if (!docFromDB && !args.data) {
100 |             if (!disableErrors) {
101 |                 throw new NotFound(req.t);
                                ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/findByID.js:101:27
      at processTicksAndRejections (native:7:39)

(pass) File Management Functions > should fail to delete a non-existent file [2.67ms]

server/internal/media-management.test.ts:
(pass) Media Management > should fail to create media with invalid data [0.29ms]
(pass) Media Management > Should create image media [30.85ms]
(pass) Media Management > should get all media in database [4.41ms]
(pass) Media Management > should get media by filename [34.28ms]
 7 |             isReadingStaticFile,
 8 |             req
 9 |         });
10 |         if (!resolvedConstraint) {
11 |             if (!disableErrors) {
12 |                 throw new Forbidden(req.t);
                               ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/auth/executeAccess.js:12:27
      at processTicksAndRejections (native:7:39)

(pass) Media Management > should fail to get media with non-existent filename [0.95ms]
(pass) Media Management > should fail to get media with empty filename [0.10ms]
(pass) Media Management > should get media buffer from filename [44.66ms]
(pass) Media Management > should fail to get buffer for non-existent file [3.23ms]
(pass) Media Management > should fail to get buffer with empty filename [0.15ms]
(pass) Media Management > should find media by user [104.04ms]
(pass) Media Management > should find media by user with pagination [5.49ms]
 96 |             throw new NotFound(t);
 97 |         }
 98 |         const docFromDB = await req.payload.db.findOne(findOneArgs);
 99 |         if (!docFromDB && !args.data) {
100 |             if (!disableErrors) {
101 |                 throw new NotFound(req.t);
                                ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/findByID.js:101:27
      at processTicksAndRejections (native:7:39)

(pass) Media Management > should delete a single media record [74.78ms]
(pass) Media Management > should fail to delete media with usage [59.56ms]
 96 |             throw new NotFound(t);
 97 |         }
 98 |         const docFromDB = await req.payload.db.findOne(findOneArgs);
 99 |         if (!docFromDB && !args.data) {
100 |             if (!disableErrors) {
101 |                 throw new NotFound(req.t);
                                ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/findByID.js:101:27
      at processTicksAndRejections (native:7:39)

 96 |             throw new NotFound(t);
 97 |         }
 98 |         const docFromDB = await req.payload.db.findOne(findOneArgs);
 99 |         if (!docFromDB && !args.data) {
100 |             if (!disableErrors) {
101 |                 throw new NotFound(req.t);
                                ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/findByID.js:101:27
      at processTicksAndRejections (native:7:39)

 96 |             throw new NotFound(t);
 97 |         }
 98 |         const docFromDB = await req.payload.db.findOne(findOneArgs);
 99 |         if (!docFromDB && !args.data) {
100 |             if (!disableErrors) {
101 |                 throw new NotFound(req.t);
                                ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/findByID.js:101:27
      at processTicksAndRejections (native:7:39)

(pass) Media Management > should delete multiple media records (batch delete) [129.44ms]
(pass) Media Management > should fail to delete media with empty array [0.12ms]
 7 |             isReadingStaticFile,
 8 |             req
 9 |         });
10 |         if (!resolvedConstraint) {
11 |             if (!disableErrors) {
12 |                 throw new Forbidden(req.t);
                               ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/auth/executeAccess.js:12:27
      at processTicksAndRejections (native:7:39)

(pass) Media Management > should fail to delete non-existent media [0.99ms]
(pass) Media Management > should fail to delete media when some IDs don't exist [30.05ms]
(pass) Media Management > should fail to delete multiple media when one has usage [107.57ms]
(pass) Media Management > should get user media stats [76.34ms]
(pass) Media Management > should get system media stats [1.86ms]
(pass) Media Management > should rename media file [69.58ms]
(pass) Media Management > should fail to rename media with duplicate filename [59.41ms]
(pass) Media Management > should get orphaned media files [46.01ms]
(pass) Media Management > should get orphaned media with pagination [43.83ms]
(pass) Media Management > should delete orphaned media files [29.07ms]
(pass) Media Management > should fail to delete non-orphaned media files [25.69ms]
(pass) Media Management > should fail to delete orphaned media with empty array [0.09ms]
(pass) Media Management > should find all media usages across collections [429.69ms]
(pass) Media Management > should find no usages for media with no references [25.85ms]
 7 |             isReadingStaticFile,
 8 |             req
 9 |         });
10 |         if (!resolvedConstraint) {
11 |             if (!disableErrors) {
12 |                 throw new Forbidden(req.t);
                               ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/auth/executeAccess.js:12:27
      at processTicksAndRejections (native:7:39)

(pass) Media Management > should fail to find usages for non-existent media [0.75ms]
(pass) Media Management > should fail to find usages with invalid media ID [0.05ms]

server/internal/course-section-management.test.ts:
(pass) Course Section Management Functions > should create a nested section with valid parent [39.51ms]
(pass) Course Section Management Functions > should create deeply nested sections (3+ levels) [64.37ms]
(pass) Course Section Management Functions > should prevent circular reference when creating section [27.50ms]
(pass) Course Section Management Functions > should prevent circular reference when updating parent [71.97ms]
(pass) Course Section Management Functions > should update section properties (title, description, order) [36.29ms]
(pass) Course Section Management Functions > should delete section without children or modules [48.37ms]
(pass) Course Section Management Functions > should prevent delete section with child sections [55.96ms]
(pass) Course Section Management Functions > should prevent delete section with activity modules [70.53ms]
(pass) Course Section Management Functions > should find sections by course [16.10ms]
(pass) Course Section Management Functions > should find root sections [15.04ms]
(pass) Course Section Management Functions > should find child sections [87.52ms]
(pass) Course Section Management Functions > should get section tree structure [12.21ms]
(pass) Course Section Management Functions > should get section ancestors [96.55ms]
(pass) Course Section Management Functions > should calculate section depth [63.16ms]
(pass) Course Section Management Functions > should reorder single section [115.60ms]
(pass) Course Section Management Functions > should reorder multiple sections in batch [175.84ms]
(pass) Course Section Management Functions > should nest section under parent [111.66ms]
(pass) Course Section Management Functions > should unnest section to root [99.57ms]
(pass) Course Section Management Functions > should move section between parents [123.16ms]
(pass) Course Section Management Functions > should add activity module to section [71.07ms]
(pass) Course Section Management Functions > should remove activity module from section [103.59ms]
(pass) Course Section Management Functions > should reorder activity modules within section [130.32ms]
(pass) Course Section Management Functions > should move activity module between sections [154.75ms]
(pass) Course Section Management Functions > should count modules in section [81.43ms]
(pass) Course Section Management Functions > should validate no circular reference [76.13ms]
(pass) Course Section Management Functions > should get course structure with nested sections and activity modules [290.20ms]
(pass) Course Section Management Functions > should get course structure with empty course [12.97ms]
(pass) Course Section Management Functions > should get course structure with sections but no activity modules [175.99ms]
(pass) Course Section Management Functions > should handle course structure with deeply nested sections [150.27ms]
(pass) Course Section Management Functions > should prevent delete last section in course [16.55ms]
(pass) Course Section Management Functions > should allow delete section when course has multiple sections [110.21ms]

(pass) Course Section Management Functions > should generate tree representation from course structure [221.48ms]


(pass) Course Section Management Functions > should create complex course structure with exact tree specification [1093.87ms]











(pass) Course Section Management Functions > tryGeneralMove - comprehensive move scenarios [628.28ms]
(pass) Course Section Management Functions > should move activity module above another activity module [690.30ms]



(pass) Course Section Management Functions > should respect custom module names from course module settings [275.63ms]

server/internal/page-management.test.ts:
(pass) Page Management Functions > should create a page with valid content [5.14ms]
(pass) Page Management Functions > should create a page with empty content [3.93ms]
(pass) Page Management Functions > should fail to create a page without userId [0.29ms]
(pass) Page Management Functions > should get a page by ID [7.57ms]
 96 |             throw new NotFound(t);
 97 |         }
 98 |         const docFromDB = await req.payload.db.findOne(findOneArgs);
 99 |         if (!docFromDB && !args.data) {
100 |             if (!disableErrors) {
101 |                 throw new NotFound(req.t);
                                ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/findByID.js:101:27
      at processTicksAndRejections (native:7:39)

(pass) Page Management Functions > should fail to get a non-existent page [1.34ms]
(pass) Page Management Functions > should update a page content [15.57ms]
(pass) Page Management Functions > should create a page with media references in HTML [5.40ms]
263 | 				expect(updateResult.value.media).toBeDefined();
264 | 				if (Array.isArray(updateResult.value.media)) {
265 | 					expect(updateResult.value.media.length).toBe(1);
266 | 					const mediaId =updateResult.value.media[0]
267 | 
268 | 					expect(mediaId).toBe(testMediaId);
                           ^
error: expect(received).toBe(expected)

Expected: 1
Received: {

      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/page-management.test.ts:268:22)
(fail) Page Management Functions > should update page media array when content changes [18.30ms]
 96 |             throw new NotFound(t);
 97 |         }
 98 |         const docFromDB = await req.payload.db.findOne(findOneArgs);
 99 |         if (!docFromDB && !args.data) {
100 |             if (!disableErrors) {
101 |                 throw new NotFound(req.t);
                                ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/findByID.js:101:27
      at processTicksAndRejections (native:7:39)

(pass) Page Management Functions > should fail to update a non-existent page [2.42ms]
 96 |             throw new NotFound(t);
 97 |         }
 98 |         const docFromDB = await req.payload.db.findOne(findOneArgs);
 99 |         if (!docFromDB && !args.data) {
100 |             if (!disableErrors) {
101 |                 throw new NotFound(req.t);
                                ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/findByID.js:101:27
      at processTicksAndRejections (native:7:39)

(pass) Page Management Functions > should delete a page [23.54ms]
 96 |             throw new NotFound(t);
 97 |         }
 98 |         const docFromDB = await req.payload.db.findOne(findOneArgs);
 99 |         if (!docFromDB && !args.data) {
100 |             if (!disableErrors) {
101 |                 throw new NotFound(req.t);
                                ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/findByID.js:101:27
      at processTicksAndRejections (native:7:39)

(pass) Page Management Functions > should fail to delete a non-existent page [3.51ms]

server/internal/whiteboard-management.test.ts:
(pass) Whiteboard Management Functions > should create a whiteboard with valid JSON content [5.07ms]
(pass) Whiteboard Management Functions > should create a whiteboard with empty content [3.62ms]
(pass) Whiteboard Management Functions > should fail to create a whiteboard without userId [0.08ms]
(pass) Whiteboard Management Functions > should get a whiteboard by ID [7.07ms]
 96 |             throw new NotFound(t);
 97 |         }
 98 |         const docFromDB = await req.payload.db.findOne(findOneArgs);
 99 |         if (!docFromDB && !args.data) {
100 |             if (!disableErrors) {
101 |                 throw new NotFound(req.t);
                                ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/findByID.js:101:27
      at processTicksAndRejections (native:7:39)

(pass) Whiteboard Management Functions > should fail to get a non-existent whiteboard [1.20ms]
(pass) Whiteboard Management Functions > should update a whiteboard content [8.84ms]
 96 |             throw new NotFound(t);
 97 |         }
 98 |         const docFromDB = await req.payload.db.findOne(findOneArgs);
 99 |         if (!docFromDB && !args.data) {
100 |             if (!disableErrors) {
101 |                 throw new NotFound(req.t);
                                ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/findByID.js:101:27
      at processTicksAndRejections (native:7:39)

(pass) Whiteboard Management Functions > should fail to update a non-existent whiteboard [1.19ms]
 96 |             throw new NotFound(t);
 97 |         }
 98 |         const docFromDB = await req.payload.db.findOne(findOneArgs);
 99 |         if (!docFromDB && !args.data) {
100 |             if (!disableErrors) {
101 |                 throw new NotFound(req.t);
                                ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/findByID.js:101:27
      at processTicksAndRejections (native:7:39)

(pass) Whiteboard Management Functions > should delete a whiteboard [12.18ms]
 96 |             throw new NotFound(t);
 97 |         }
 98 |         const docFromDB = await req.payload.db.findOne(findOneArgs);
 99 |         if (!docFromDB && !args.data) {
100 |             if (!disableErrors) {
101 |                 throw new NotFound(req.t);
                                ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/findByID.js:101:27
      at processTicksAndRejections (native:7:39)

(pass) Whiteboard Management Functions > should fail to delete a non-existent whiteboard [0.81ms]

server/internal/course-category-management.test.ts:
(pass) Course Category Management Functions > should create a root category [4.34ms]
(pass) Course Category Management Functions > should create a nested category with valid parent [19.90ms]
49 | 					const parentId =
50 | 						typeof data.parent === "number" ? data.parent : data.parent.id;
51 | 					const currentId = originalDoc?.id;
52 | 
53 | 					if (parentId === currentId) {
54 | 						throw new Error("A category cannot be its own parent");
                     ^
error: A category cannot be its own parent
      at /Users/yomaruhananoshika/repos/@paideia/paideia/server/collections/course-categories.ts:54:17
      at /Users/yomaruhananoshika/repos/@paideia/paideia/server/collections/course-categories.ts:49:6
      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/utilities/update.js:135:14
      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/updateByID.js:148:25
      at processTicksAndRejections (native:7:39)

(pass) Course Category Management Functions > should prevent circular reference when creating category [12.05ms]
60 | 							req.payload,
61 | 							currentId,
62 | 							parentId,
63 | 						);
64 | 						if (isDescendant) {
65 | 							throw new Error(
                      ^
error: Cannot set parent to a descendant category (circular reference)
      at /Users/yomaruhananoshika/repos/@paideia/paideia/server/collections/course-categories.ts:65:18
      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/utilities/update.js:135:14
      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/updateByID.js:148:25
      at processTicksAndRejections (native:7:39)

(pass) Course Category Management Functions > should prevent circular reference when updating parent [28.94ms]
82 | 							typeof data.parent === "number" ? data.parent : data.parent.id;
83 | 						const parentDepth = await calculateDepth(req.payload, parentId);
84 | 						const newDepth = parentDepth + 1;
85 | 
86 | 						if (newDepth >= maxDepth) {
87 | 							throw new Error(
                      ^
error: Category depth limit exceeded. Maximum allowed depth is 2
      at /Users/yomaruhananoshika/repos/@paideia/paideia/server/collections/course-categories.ts:87:18
      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/create.js:138:26
      at processTicksAndRejections (native:7:39)

(pass) Course Category Management Functions > should enforce max category depth when configured [39.79ms]
(pass) Course Category Management Functions > should update category name [12.64ms]
(pass) Course Category Management Functions > should change category parent [99.22ms]
(pass) Course Category Management Functions > should delete empty category [132.81ms]
(pass) Course Category Management Functions > should fail to delete category with subcategories [144.38ms]
(pass) Course Category Management Functions > should fail to delete category with courses [154.03ms]
(pass) Course Category Management Functions > should find category by ID [15.37ms]
(pass) Course Category Management Functions > should get category tree structure [161.92ms]
(pass) Course Category Management Functions > should get category ancestors [29.21ms]
(pass) Course Category Management Functions > should calculate category depth correctly [35.68ms]
(pass) Course Category Management Functions > should count total nested courses correctly [82.84ms]
(pass) Course Category Management Functions > should find root categories [16.79ms]
(pass) Course Category Management Functions > should find subcategories [21.80ms]
(pass) Course Category Management Functions > should assign course to category [31.21ms]
(pass) Course Category Management Functions > should move course between categories [58.86ms]

server/internal/course-management.test.ts:
(pass) Course Management Functions > tryCreateCourse > should create a new course successfully [17.72ms]
(pass) Course Management Functions > tryCreateCourse > should create course with default values [13.75ms]
540 |         result = new this._Promise((resolve, reject) => {
541 |           query.callback = (err, res) => (err ? reject(err) : resolve(res))
542 |         }).catch((err) => {
543 |           // replace the stack trace that leads to `TCP.onStreamRead` with one that leads back to the
544 |           // application that created the query
545 |           Error.captureStackTrace(err)
                      ^
error: insert or update on table "courses" violates foreign key constraint "courses_created_by_id_users_id_fk"

      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/pg/lib/client.js:545:17)

(pass) Course Management Functions > tryCreateCourse > should fail when instructor does not exist [3.58ms]
(pass) Course Management Functions > tryUpdateCourse > should update course successfully [49.61ms]
(pass) Course Management Functions > tryUpdateCourse > should create a course with media references in description [14.16ms]
(pass) Course Management Functions > tryUpdateCourse > should update course media array when description changes [41.68ms]
(pass) Course Management Functions > tryUpdateCourse > should update course category [60.57ms]
(pass) Course Management Functions > tryFindCourseById > should find existing course by ID [17.43ms]
418 | 			})
419 | 			.then((result) => {
420 | 				console.log("result", result);
421 | 				const course = result.docs[0];
422 | 				if (!course) {
423 | 					throw new Error("Course not found");
                     ^
error: Course not found
      at /Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/course-management.ts:423:16
      at processTicksAndRejections (native:7:39)

(pass) Course Management Functions > tryFindCourseById > should fail when finding non-existent course by ID [3.04ms]
(pass) Course Management Functions > trySearchCourses > should search courses with no filters [12.01ms]
(pass) Course Management Functions > trySearchCourses > should search courses by title [37.42ms]
418 | 			})
419 | 			.then((result) => {
420 | 				console.log("result", result);
421 | 				const course = result.docs[0];
422 | 				if (!course) {
423 | 					throw new Error("Course not found");
                     ^
error: Course not found
      at /Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/course-management.ts:423:16
      at processTicksAndRejections (native:7:39)

(pass) Course Management Functions > tryDeleteCourse > should delete course successfully [43.90ms]
(pass) Course Management Functions > tryFindCoursesByInstructor > should find courses by instructor [0.08ms]
(pass) Course Management Functions > tryFindPublishedCourses > should find only published courses [0.04ms]
418 | 			})
419 | 			.then((result) => {
420 | 				console.log("result", result);
421 | 				const course = result.docs[0];
422 | 				if (!course) {
423 | 					throw new Error("Course not found");
                     ^
error: Course not found
      at /Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/course-management.ts:423:16
      at processTicksAndRejections (native:7:39)

(pass) Course Management Functions > Integration Tests > should handle complete course lifecycle [76.38ms]
(pass) Course Management Functions > tryGetUserAccessibleCourses > should return only owned courses for admin user [36.54ms]
(pass) Course Management Functions > tryGetUserAccessibleCourses > should return only owned courses for content manager user [30.97ms]
(pass) Course Management Functions > tryGetUserAccessibleCourses > should return courses from enrollments and ownership for regular user [41.34ms]
(pass) Course Management Functions > tryGetUserAccessibleCourses > should not return courses from category roles for regular user [25.76ms]
(pass) Course Management Functions > tryGetUserAccessibleCourses > should not return courses user has no access to [24.97ms]
(pass) Course Management Functions > tryGetUserAccessibleCourses > should prioritize enrollment over ownership when user has both [69.84ms]
(pass) Course Management Functions > tryGetUserAccessibleCourses > should handle completed enrollment status [62.00ms]
(pass) Course Management Functions > tryGetUserAccessibleCourses > should handle user with no course access [52.50ms]
 7 |             isReadingStaticFile,
 8 |             req
 9 |         });
10 |         if (!resolvedConstraint) {
11 |             if (!disableErrors) {
12 |                 throw new Forbidden(req.t);
                               ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/auth/executeAccess.js:12:27
      at processTicksAndRejections (native:7:39)

1177 | 				expect(ownedCourse?.source).toBe("owner");
1178 | 				expect(ownedCourse?.role).toBeNull();
1179 | 				expect(ownedCourse?.createdBy).toBe(testUserId);
1180 | 
1181 | 				// Should see course3 (enrolled in)
1182 | 				expect(courseIds).toContain(course3Id);
                             ^
error: expect(received).toContain(expected)

Received: [ 1 ]

      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/course-management.test.ts:1182:23)
(fail) Course Management Functions > tryGetUserAccessibleCourses - Access Control Tests > should only return courses user owns or is enrolled in with overrideAccess false [8.34ms]
(pass) Course Management Functions > tryGetUserAccessibleCourses - Access Control Tests > should work with overrideAccess true even for different user [16.50ms]
(pass) Course Management Functions > tryGetUserAccessibleCourses - Access Control Tests > should handle user with no courses gracefully [49.93ms]
(pass) Course Management Functions > tryGetUserAccessibleCourses - Access Control Tests > should prioritize enrollment over ownership when user has both [60.32ms]

server/internal/user-management.test.ts:
(pass) User Management Functions > tryCreateUser > should create a new user successfully with overrideAccess [46.81ms]
116 | 			req,
117 | 			overrideAccess,
118 | 		});
119 | 
120 | 		if (existingUsers.docs.length > 0) {
121 | 			throw new Error(`User with email ${email} already exists`);
                   ^
error: User with email duplicate@example.com already exists
      at /Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/user-management.ts:121:14
      at processTicksAndRejections (native:7:39)

(pass) User Management Functions > tryCreateUser > should fail when creating user with duplicate email [52.39ms]
(pass) User Management Functions > tryCreateUser > should create user with default role as user [55.94ms]
(pass) User Management Functions > tryCreateUser > admin should be able to create users [55.34ms]
 7 |             isReadingStaticFile,
 8 |             req
 9 |         });
10 |         if (!resolvedConstraint) {
11 |             if (!disableErrors) {
12 |                 throw new Forbidden(req.t);
                               ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/auth/executeAccess.js:12:27
      at processTicksAndRejections (native:7:39)

(pass) User Management Functions > tryCreateUser > unauthenticated request should fail to create user [0.85ms]
(pass) User Management Functions > tryCreateUser > should create user with explicit theme value [42.14ms]
(pass) User Management Functions > tryCreateUser > should create user with default theme as light when not specified [45.05ms]
(pass) User Management Functions > tryUpdateUser > should update user successfully with overrideAccess [72.36ms]
83 |             payload,
84 |             query: findOneArgs,
85 |             req
86 |         });
87 |         if (!docWithLocales && !hasWherePolicy) {
88 |             throw new NotFound(req.t);
                           ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/updateByID.js:88:23
      at processTicksAndRejections (native:7:39)

(pass) User Management Functions > tryUpdateUser > should fail when updating non-existent user [5.91ms]
 7 |             isReadingStaticFile,
 8 |             req
 9 |         });
10 |         if (!resolvedConstraint) {
11 |             if (!disableErrors) {
12 |                 throw new Forbidden(req.t);
                               ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/auth/executeAccess.js:12:27
      at processTicksAndRejections (native:7:39)

(pass) User Management Functions > tryUpdateUser > unauthenticated request should fail to update user [1.30ms]
(pass) User Management Functions > tryUpdateUser > should update user theme from light to dark [85.31ms]
(pass) User Management Functions > tryFindUserByEmail > should find existing user by email with overrideAccess [57.49ms]
(pass) User Management Functions > tryFindUserByEmail > should return null for non-existent email [3.71ms]
 7 |             isReadingStaticFile,
 8 |             req
 9 |         });
10 |         if (!resolvedConstraint) {
11 |             if (!disableErrors) {
12 |                 throw new Forbidden(req.t);
                               ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/auth/executeAccess.js:12:27
      at processTicksAndRejections (native:7:39)

(pass) User Management Functions > tryFindUserByEmail > unauthenticated request should fail to find user [0.62ms]
(pass) User Management Functions > tryFindUserById > should find existing user by ID with overrideAccess [46.04ms]
 96 |             throw new NotFound(t);
 97 |         }
 98 |         const docFromDB = await req.payload.db.findOne(findOneArgs);
 99 |         if (!docFromDB && !args.data) {
100 |             if (!disableErrors) {
101 |                 throw new NotFound(req.t);
                                ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/findByID.js:101:27
      at processTicksAndRejections (native:7:39)

(pass) User Management Functions > tryFindUserById > should fail when finding non-existent user by ID [1.71ms]
 7 |             isReadingStaticFile,
 8 |             req
 9 |         });
10 |         if (!resolvedConstraint) {
11 |             if (!disableErrors) {
12 |                 throw new Forbidden(req.t);
                               ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/auth/executeAccess.js:12:27
      at processTicksAndRejections (native:7:39)

(pass) User Management Functions > tryFindUserById > unauthenticated request should fail to find user [0.35ms]
 96 |             throw new NotFound(t);
 97 |         }
 98 |         const docFromDB = await req.payload.db.findOne(findOneArgs);
 99 |         if (!docFromDB && !args.data) {
100 |             if (!disableErrors) {
101 |                 throw new NotFound(req.t);
                                ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/findByID.js:101:27
      at processTicksAndRejections (native:7:39)

(pass) User Management Functions > tryDeleteUser > should delete user successfully with overrideAccess [74.54ms]
(pass) User Management Functions > tryDeleteUser > admin should be able to delete any user [63.53ms]
 7 |             isReadingStaticFile,
 8 |             req
 9 |         });
10 |         if (!resolvedConstraint) {
11 |             if (!disableErrors) {
12 |                 throw new Forbidden(req.t);
                               ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/auth/executeAccess.js:12:27
      at processTicksAndRejections (native:7:39)

(pass) User Management Functions > tryDeleteUser > unauthenticated request should fail to delete user [1.71ms]
(pass) User Management Functions > tryFindAllUsers > should find all users with overrideAccess [128.46ms]
(pass) User Management Functions > tryFindAllUsers > should support pagination [2.50ms]
(pass) User Management Functions > tryFindAllUsers > should support sorting [2.77ms]
(pass) User Management Functions > tryFindAllUsers > admin should be able to find all users [4.96ms]
 7 |             isReadingStaticFile,
 8 |             req
 9 |         });
10 |         if (!resolvedConstraint) {
11 |             if (!disableErrors) {
12 |                 throw new Forbidden(req.t);
                               ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/auth/executeAccess.js:12:27
      at processTicksAndRejections (native:7:39)

(pass) User Management Functions > tryFindAllUsers > unauthenticated request should fail to find all users [0.68ms]
(pass) User Management Functions > tryFindAllUsers > should comprehensively test search functionality with text and role filters [270.32ms]
 96 |             throw new NotFound(t);
 97 |         }
 98 |         const docFromDB = await req.payload.db.findOne(findOneArgs);
 99 |         if (!docFromDB && !args.data) {
100 |             if (!disableErrors) {
101 |                 throw new NotFound(req.t);
                                ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/findByID.js:101:27
      at processTicksAndRejections (native:7:39)

(pass) User Management Functions > Integration Tests > should handle complete user lifecycle with overrideAccess [91.66ms]
(pass) User Management Functions > User Impersonation > should not allow admin to impersonate another admin [73.57ms]
(pass) User Management Functions > User Impersonation > should return null for invalid user ID [0.37ms]
 96 |             throw new NotFound(t);
 97 |         }
 98 |         const docFromDB = await req.payload.db.findOne(findOneArgs);
 99 |         if (!docFromDB && !args.data) {
100 |             if (!disableErrors) {
101 |                 throw new NotFound(req.t);
                                ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/findByID.js:101:27
      at processTicksAndRejections (native:7:39)

(pass) User Management Functions > User Impersonation > should return null for non-existent user ID [2.78ms]

server/internal/quiz-submission-management-full-workflow.test.ts:
 7 |             isReadingStaticFile,
 8 |             req
 9 |         });
10 |         if (!resolvedConstraint) {
11 |             if (!disableErrors) {
12 |                 throw new Forbidden(req.t);
                               ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/auth/executeAccess.js:12:27
      at processTicksAndRejections (native:7:39)

372 | 			createdBy: teacherId,
373 | 		};
374 | 
375 | 		const result = await tryCreateQuiz(args);
376 | 
377 | 		expect(result.ok).toBe(true);
                          ^
error: expect(received).toBe(expected)

Expected: true
Received: false

      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/quiz-submission-management-full-workflow.test.ts:377:21)
(fail) Quiz Management - Full Workflow > should create quiz (teacher workflow) [3.47ms]
796 | 		}
797 | 
798 | 		const quizSettings =
799 | 			courseModuleLink.settings as unknown as LatestQuizSettings;
800 | 
801 | 		const isLate = quizSettings.closingTime
                       ^
TypeError: null is not an object (evaluating 'quizSettings.closingTime')
      at /Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/quiz-submission-management.ts:801:18
      at processTicksAndRejections (native:7:39)

437 | 			overrideAccess: true,
438 | 		};
439 | 
440 | 		const result = await tryCreateQuizSubmission(args);
441 | 
442 | 		expect(result.ok).toBe(true);
                          ^
error: expect(received).toBe(expected)

Expected: true
Received: false

      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/quiz-submission-management-full-workflow.test.ts:442:21)
(fail) Quiz Management - Full Workflow > should create quiz submission (student workflow) [48.29ms]
796 | 		}
797 | 
798 | 		const quizSettings =
799 | 			courseModuleLink.settings as unknown as LatestQuizSettings;
800 | 
801 | 		const isLate = quizSettings.closingTime
                       ^
TypeError: null is not an object (evaluating 'quizSettings.closingTime')
      at /Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/quiz-submission-management.ts:801:18
      at processTicksAndRejections (native:7:39)

481 | 			],
482 | 			overrideAccess: true,
483 | 		};
484 | 
485 | 		const createResult = await tryCreateQuizSubmission(createArgs);
486 | 		expect(createResult.ok).toBe(true);
                                ^
error: expect(received).toBe(expected)

Expected: true
Received: false

      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/quiz-submission-management-full-workflow.test.ts:486:27)
(fail) Quiz Management - Full Workflow > should update quiz submission (student editing answers) [10.02ms]
796 | 		}
797 | 
798 | 		const quizSettings =
799 | 			courseModuleLink.settings as unknown as LatestQuizSettings;
800 | 
801 | 		const isLate = quizSettings.closingTime
                       ^
TypeError: null is not an object (evaluating 'quizSettings.closingTime')
      at /Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/quiz-submission-management.ts:801:18
      at processTicksAndRejections (native:7:39)

565 | 			],
566 | 			overrideAccess: true,
567 | 		};
568 | 
569 | 		const createResult = await tryCreateQuizSubmission(createArgs);
570 | 		expect(createResult.ok).toBe(true);
                                ^
error: expect(received).toBe(expected)

Expected: true
Received: false

      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/quiz-submission-management-full-workflow.test.ts:570:27)
(fail) Quiz Management - Full Workflow > should submit quiz (student submits for grading) [6.89ms]
 7 |             isReadingStaticFile,
 8 |             req
 9 |         });
10 |         if (!resolvedConstraint) {
11 |             if (!disableErrors) {
12 |                 throw new Forbidden(req.t);
                               ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/auth/executeAccess.js:12:27
      at processTicksAndRejections (native:7:39)

641 | 			req: mockRequest,
642 | 			quizId,
643 | 			answers,
644 | 		});
645 | 
646 | 		expect(result.ok).toBe(true);
                          ^
error: expect(received).toBe(expected)

Expected: true
Received: false

      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/quiz-submission-management-full-workflow.test.ts:646:21)
(fail) Quiz Management - Full Workflow > should calculate quiz grade automatically [9.49ms]
(pass) Quiz Management - Full Workflow > should get quiz by ID [4.98ms]
796 | 		}
797 | 
798 | 		const quizSettings =
799 | 			courseModuleLink.settings as unknown as LatestQuizSettings;
800 | 
801 | 		const isLate = quizSettings.closingTime
                       ^
TypeError: null is not an object (evaluating 'quizSettings.closingTime')
      at /Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/quiz-submission-management.ts:801:18
      at processTicksAndRejections (native:7:39)

732 | 			],
733 | 			overrideAccess: true,
734 | 		};
735 | 
736 | 		const createResult = await tryCreateQuizSubmission(createArgs);
737 | 		expect(createResult.ok).toBe(true);
                                ^
error: expect(received).toBe(expected)

Expected: true
Received: false

      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/quiz-submission-management-full-workflow.test.ts:737:27)
(fail) Quiz Management - Full Workflow > should get quiz submission by ID [17.39ms]
769 | 
770 | 		expect(listResult.ok).toBe(true);
771 | 		if (!listResult.ok) return;
772 | 
773 | 		const submissions = listResult.value;
774 | 		expect(submissions.docs.length).toBeGreaterThan(0);
                                        ^
error: expect(received).toBeGreaterThan(expected)

Expected: > 0
Received: 0

      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/quiz-submission-management-full-workflow.test.ts:774:35)
(fail) Quiz Management - Full Workflow > should list quiz submissions with filtering [4.56ms]
796 | 		}
797 | 
798 | 		const quizSettings =
799 | 			courseModuleLink.settings as unknown as LatestQuizSettings;
800 | 
801 | 		const isLate = quizSettings.closingTime
                       ^
TypeError: null is not an object (evaluating 'quizSettings.closingTime')
      at /Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/quiz-submission-management.ts:801:18
      at processTicksAndRejections (native:7:39)

834 | 			overrideAccess: true,
835 | 		};
836 | 
837 | 		const result = await tryCreateQuizSubmission(lateArgs);
838 | 
839 | 		expect(result.ok).toBe(true);
                          ^
error: expect(received).toBe(expected)

Expected: true
Received: false

      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/quiz-submission-management-full-workflow.test.ts:839:21)
(fail) Quiz Management - Full Workflow > should handle late submissions [15.31ms]
796 | 		}
797 | 
798 | 		const quizSettings =
799 | 			courseModuleLink.settings as unknown as LatestQuizSettings;
800 | 
801 | 		const isLate = quizSettings.closingTime
                       ^
TypeError: null is not an object (evaluating 'quizSettings.closingTime')
      at /Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/quiz-submission-management.ts:801:18
      at processTicksAndRejections (native:7:39)

869 | 			overrideAccess: true,
870 | 		};
871 | 
872 | 		// Create first submission
873 | 		const firstResult = await tryCreateQuizSubmission(args);
874 | 		expect(firstResult.ok).toBe(true);
                               ^
error: expect(received).toBe(expected)

Expected: true
Received: false

      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/quiz-submission-management-full-workflow.test.ts:874:26)
(fail) Quiz Management - Full Workflow > should prevent duplicate submissions for same attempt [17.76ms]
796 | 		}
797 | 
798 | 		const quizSettings =
799 | 			courseModuleLink.settings as unknown as LatestQuizSettings;
800 | 
801 | 		const isLate = quizSettings.closingTime
                       ^
TypeError: null is not an object (evaluating 'quizSettings.closingTime')
      at /Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/quiz-submission-management.ts:801:18
      at processTicksAndRejections (native:7:39)

901 | 			],
902 | 			overrideAccess: true,
903 | 		};
904 | 
905 | 		const createResult = await tryCreateQuizSubmission(createArgs);
906 | 		expect(createResult.ok).toBe(true);
                                ^
error: expect(received).toBe(expected)

Expected: true
Received: false

      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/quiz-submission-management-full-workflow.test.ts:906:27)
(fail) Quiz Management - Full Workflow > should only allow grading of completed quizzes [16.79ms]
796 | 		}
797 | 
798 | 		const quizSettings =
799 | 			courseModuleLink.settings as unknown as LatestQuizSettings;
800 | 
801 | 		const isLate = quizSettings.closingTime
                       ^
TypeError: null is not an object (evaluating 'quizSettings.closingTime')
      at /Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/quiz-submission-management.ts:801:18
      at processTicksAndRejections (native:7:39)

944 | 			],
945 | 			overrideAccess: true,
946 | 		};
947 | 
948 | 		const createResult = await tryCreateQuizSubmission(createArgs);
949 | 		expect(createResult.ok).toBe(true);
                                ^
error: expect(received).toBe(expected)

Expected: true
Received: false

      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/quiz-submission-management-full-workflow.test.ts:949:27)
(fail) Quiz Management - Full Workflow > should delete quiz submission [20.80ms]
796 | 		}
797 | 
798 | 		const quizSettings =
799 | 			courseModuleLink.settings as unknown as LatestQuizSettings;
800 | 
801 | 		const isLate = quizSettings.closingTime
                       ^
TypeError: null is not an object (evaluating 'quizSettings.closingTime')
      at /Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/quiz-submission-management.ts:801:18
      at processTicksAndRejections (native:7:39)

988 | 				],
989 | 				overrideAccess: true,
990 | 			};
991 | 
992 | 			const createResult = await tryCreateQuizSubmission(createArgs);
993 | 			expect(createResult.ok).toBe(true);
                                 ^
error: expect(received).toBe(expected)

Expected: true
Received: false

      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/quiz-submission-management-full-workflow.test.ts:993:28)
(fail) Quiz Management - Full Workflow > should handle pagination in listing [22.12ms]
(pass) Quiz Management - Full Workflow > should fail with invalid arguments [0.71ms]
(pass) Quiz Management - Full Workflow > should fail to get non-existent submission [4.77ms]
83 |             payload,
84 |             query: findOneArgs,
85 |             req
86 |         });
87 |         if (!docWithLocales && !hasWherePolicy) {
88 |             throw new NotFound(req.t);
                           ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/updateByID.js:88:23
      at processTicksAndRejections (native:7:39)

(pass) Quiz Management - Full Workflow > should fail to update non-existent submission [5.30ms]
 96 |             throw new NotFound(t);
 97 |         }
 98 |         const docFromDB = await req.payload.db.findOne(findOneArgs);
 99 |         if (!docFromDB && !args.data) {
100 |             if (!disableErrors) {
101 |                 throw new NotFound(req.t);
                                ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/findByID.js:101:27
      at processTicksAndRejections (native:7:39)

(pass) Quiz Management - Full Workflow > should fail to delete non-existent submission [2.55ms]
 7 |             isReadingStaticFile,
 8 |             req
 9 |         });
10 |         if (!resolvedConstraint) {
11 |             if (!disableErrors) {
12 |                 throw new Forbidden(req.t);
                               ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/auth/executeAccess.js:12:27
      at processTicksAndRejections (native:7:39)

1144 | 			createdBy: teacherId,
1145 | 		};
1146 | 
1147 | 		// Create the quiz
1148 | 		const createResult = await tryCreateQuiz(args);
1149 | 		expect(createResult.ok).toBe(true);
                                 ^
error: expect(received).toBe(expected)

Expected: true
Received: false

      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/quiz-submission-management-full-workflow.test.ts:1149:27)
(fail) Quiz Management - Full Workflow > should store and retrieve rawQuizConfig [1.81ms]
 7 |             isReadingStaticFile,
 8 |             req
 9 |         });
10 |         if (!resolvedConstraint) {
11 |             if (!disableErrors) {
12 |                 throw new Forbidden(req.t);
                               ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/auth/executeAccess.js:12:27
      at processTicksAndRejections (native:7:39)

1218 | 			],
1219 | 			createdBy: teacherId,
1220 | 		};
1221 | 
1222 | 		const quickQuizResult = await tryCreateQuiz(quickQuizArgs);
1223 | 		expect(quickQuizResult.ok).toBe(true);
                                    ^
error: expect(received).toBe(expected)

Expected: true
Received: false

      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/quiz-submission-management-full-workflow.test.ts:1223:30)
(fail) Quiz Management - Full Workflow > should reject submission after time limit exceeded [1.24ms]
 7 |             isReadingStaticFile,
 8 |             req
 9 |         });
10 |         if (!resolvedConstraint) {
11 |             if (!disableErrors) {
12 |                 throw new Forbidden(req.t);
                               ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/auth/executeAccess.js:12:27
      at processTicksAndRejections (native:7:39)

1391 | 			],
1392 | 			createdBy: teacherId,
1393 | 		};
1394 | 
1395 | 		const autoSubmitQuizResult = await tryCreateQuiz(autoSubmitQuizArgs);
1396 | 		expect(autoSubmitQuizResult.ok).toBe(true);
                                         ^
error: expect(received).toBe(expected)

Expected: true
Received: false

      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/quiz-submission-management-full-workflow.test.ts:1396:35)
(fail) Quiz Management - Full Workflow > should auto-submit quiz when timer expires [1.21ms]

server/internal/quiz-submission-management-attempt-start-retrieve.test.ts:
 7 |             isReadingStaticFile,
 8 |             req
 9 |         });
10 |         if (!resolvedConstraint) {
11 |             if (!disableErrors) {
12 |                 throw new Forbidden(req.t);
                               ^

      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/auth/executeAccess.js:12:27
      at processTicksAndRejections (native:7:39)

180 | 			order: 0,
181 | 		};
182 | 
183 | 		const linkResult = await tryCreateCourseActivityModuleLink(linkArgs);
184 | 		if (!linkResult.ok) {
185 | 			throw new Error(
                   ^
error: Test Error: Failed to create course-activity-module-link
      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/quiz-submission-management-attempt-start-retrieve.test.ts:185:14)
(fail) Quiz Attempt Management - Start and Retrieve > (unnamed) [3104.40ms]

server/internal/email.test.ts:
(pass) Email Management > should fail when recipient email is missing [0.47ms]
(pass) Email Management > should fail when recipient email format is invalid [1.95ms]

server/internal/check-first-user.test.ts:
(fail) First User Check Functions - With overrideAccess > tryCheckFirstUser > should return true when no users exist [5001.07ms]
  ^ this test timed out after 5000ms.
1 | import { buildOrderBy } from './buildOrderBy.js';
2 | import { parseParams } from './parseParams.js';
3 | export const buildQuery = function buildQuery({ adapter, aliasTable, fields, joins = [], locale, parentIsLocalized, selectLocale, sort, tableName, where: incomingWhere }) {
4 |     const selectFields = {
5 |         id: adapter.tables[tableName].id
                               ^
TypeError: undefined is not an object (evaluating 'adapter.tables[tableName].id')
      at buildQuery (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/queries/buildQuery.js:5:28)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:25:9)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:8:44)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find.js:3:40)
      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/find.js:157:21
      at processTicksAndRejections (native:7:39)

1 | import { buildOrderBy } from './buildOrderBy.js';
2 | import { parseParams } from './parseParams.js';
3 | export const buildQuery = function buildQuery({ adapter, aliasTable, fields, joins = [], locale, parentIsLocalized, selectLocale, sort, tableName, where: incomingWhere }) {
4 |     const selectFields = {
5 |         id: adapter.tables[tableName].id
                               ^
TypeError: undefined is not an object (evaluating 'adapter.tables[tableName].id')
      at buildQuery (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/queries/buildQuery.js:5:28)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:25:9)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:8:44)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find.js:3:40)
      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/find.js:157:21
      at processTicksAndRejections (native:7:39)

83 | 				overrideAccess: true,
84 | 			};
85 | 
86 | 			const result = await tryCheckFirstUser(args);
87 | 
88 | 			expect(result.ok).toBe(true);
                          ^
error: expect(received).toBe(expected)

Expected: true
Received: false

      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/check-first-user.test.ts:88:22)
(fail) First User Check Functions - With overrideAccess > tryCheckFirstUser > should return false when users exist [4.83ms]
1 | import { buildOrderBy } from './buildOrderBy.js';
2 | import { parseParams } from './parseParams.js';
3 | export const buildQuery = function buildQuery({ adapter, aliasTable, fields, joins = [], locale, parentIsLocalized, selectLocale, sort, tableName, where: incomingWhere }) {
4 |     const selectFields = {
5 |         id: adapter.tables[tableName].id
                               ^
TypeError: undefined is not an object (evaluating 'adapter.tables[tableName].id')
      at buildQuery (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/queries/buildQuery.js:5:28)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:25:9)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:8:44)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find.js:3:40)
      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/find.js:157:21
      at processTicksAndRejections (native:7:39)

 99 | 				overrideAccess: true,
100 | 			};
101 | 
102 | 			const result = await tryGetUserCount(args);
103 | 
104 | 			expect(result.ok).toBe(true);
                           ^
error: expect(received).toBe(expected)

Expected: true
Received: false

      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/check-first-user.test.ts:104:22)
(fail) First User Check Functions - With overrideAccess > tryGetUserCount > should return correct user count [0.82ms]
(fail) First User Check Functions - With overrideAccess > tryGetUserCount > should return 0 when no users exist [5000.46ms]
  ^ this test timed out after 5000ms.
1 | import { buildOrderBy } from './buildOrderBy.js';
2 | import { parseParams } from './parseParams.js';
3 | export const buildQuery = function buildQuery({ adapter, aliasTable, fields, joins = [], locale, parentIsLocalized, selectLocale, sort, tableName, where: incomingWhere }) {
4 |     const selectFields = {
5 |         id: adapter.tables[tableName].id
                               ^
TypeError: undefined is not an object (evaluating 'adapter.tables[tableName].id')
      at buildQuery (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/queries/buildQuery.js:5:28)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:25:9)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:8:44)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find.js:3:40)
      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/find.js:157:21
      at processTicksAndRejections (native:7:39)

137 | 				overrideAccess: true,
138 | 			};
139 | 
140 | 			const result = await tryValidateFirstUserState(args);
141 | 
142 | 			expect(result.ok).toBe(true);
                           ^
error: expect(received).toBe(expected)

Expected: true
Received: false

      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/check-first-user.test.ts:142:22)
(fail) First User Check Functions - With overrideAccess > tryValidateFirstUserState > should return valid state with correct structure [2.94ms]
1 | import { buildOrderBy } from './buildOrderBy.js';
2 | import { parseParams } from './parseParams.js';
3 | export const buildQuery = function buildQuery({ adapter, aliasTable, fields, joins = [], locale, parentIsLocalized, selectLocale, sort, tableName, where: incomingWhere }) {
4 |     const selectFields = {
5 |         id: adapter.tables[tableName].id
                               ^
TypeError: undefined is not an object (evaluating 'adapter.tables[tableName].id')
      at buildQuery (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/queries/buildQuery.js:5:28)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:25:9)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:8:44)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find.js:3:40)
      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/find.js:157:21
      at processTicksAndRejections (native:7:39)

156 | 				overrideAccess: true,
157 | 			};
158 | 
159 | 			const result = await tryValidateFirstUserState(args);
160 | 
161 | 			expect(result.ok).toBe(true);
                           ^
error: expect(received).toBe(expected)

Expected: true
Received: false

      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/check-first-user.test.ts:161:22)
(fail) First User Check Functions - With overrideAccess > tryValidateFirstUserState > should return isValid=true when database is accessible [0.37ms]

1 | import { buildOrderBy } from './buildOrderBy.js';
2 | import { parseParams } from './parseParams.js';
3 | export const buildQuery = function buildQuery({ adapter, aliasTable, fields, joins = [], locale, parentIsLocalized, selectLocale, sort, tableName, where: incomingWhere }) {
4 |     const selectFields = {
5 |         id: adapter.tables[tableName].id
                               ^
TypeError: undefined is not an object (evaluating 'adapter.tables[tableName].id')
      at buildQuery (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/queries/buildQuery.js:5:28)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:20:53)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:8:44)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find.js:3:40)
      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/delete.js:77:43)


1 | import { buildOrderBy } from './buildOrderBy.js';
2 | import { parseParams } from './parseParams.js';
3 | export const buildQuery = function buildQuery({ adapter, aliasTable, fields, joins = [], locale, parentIsLocalized, selectLocale, sort, tableName, where: incomingWhere }) {
4 |     const selectFields = {
5 |         id: adapter.tables[tableName].id
                               ^
TypeError: undefined is not an object (evaluating 'adapter.tables[tableName].id')
      at buildQuery (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/queries/buildQuery.js:5:28)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:20:53)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:8:44)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find.js:3:40)
      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/delete.js:77:43)

1 | import { buildOrderBy } from './buildOrderBy.js';
2 | import { parseParams } from './parseParams.js';
3 | export const buildQuery = function buildQuery({ adapter, aliasTable, fields, joins = [], locale, parentIsLocalized, selectLocale, sort, tableName, where: incomingWhere }) {
4 |     const selectFields = {
5 |         id: adapter.tables[tableName].id
                               ^
TypeError: undefined is not an object (evaluating 'adapter.tables[tableName].id')
      at buildQuery (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/queries/buildQuery.js:5:28)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:20:53)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:8:44)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find.js:3:40)
      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/delete.js:77:43)
(fail) First User Check Functions - With overrideAccess > tryValidateFirstUserState > should return userCount matching actual database state [26.45ms]
1 | import { buildOrderBy } from './buildOrderBy.js';
2 | import { parseParams } from './parseParams.js';
3 | export const buildQuery = function buildQuery({ adapter, aliasTable, fields, joins = [], locale, parentIsLocalized, selectLocale, sort, tableName, where: incomingWhere }) {
4 |     const selectFields = {
5 |         id: adapter.tables[tableName].id
                               ^
TypeError: undefined is not an object (evaluating 'adapter.tables[tableName].id')
      at buildQuery (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/queries/buildQuery.js:5:28)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:25:9)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:8:44)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find.js:3:40)
      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/find.js:157:21
      at processTicksAndRejections (native:7:39)

1 | import { buildOrderBy } from './buildOrderBy.js';
2 | import { parseParams } from './parseParams.js';
3 | export const buildQuery = function buildQuery({ adapter, aliasTable, fields, joins = [], locale, parentIsLocalized, selectLocale, sort, tableName, where: incomingWhere }) {
4 |     const selectFields = {
5 |         id: adapter.tables[tableName].id
                               ^
TypeError: undefined is not an object (evaluating 'adapter.tables[tableName].id')
      at buildQuery (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/queries/buildQuery.js:5:28)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:25:9)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:8:44)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find.js:3:40)
      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/find.js:157:21
      at processTicksAndRejections (native:7:39)

226 | 			};
227 | 
228 | 			const needsFirstUserResult = await tryCheckFirstUser(checkArgs);
229 | 			const userCountResult = await tryGetUserCount(countArgs);
230 | 
231 | 			expect(needsFirstUserResult.ok).toBe(true);
                                         ^
error: expect(received).toBe(expected)

Expected: true
Received: false

      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/check-first-user.test.ts:231:36)
(fail) First User Check Functions - With overrideAccess > Integration Tests > tryCheckFirstUser and tryGetUserCount should be consistent [0.64ms]
1 | import { buildOrderBy } from './buildOrderBy.js';
2 | import { parseParams } from './parseParams.js';
3 | export const buildQuery = function buildQuery({ adapter, aliasTable, fields, joins = [], locale, parentIsLocalized, selectLocale, sort, tableName, where: incomingWhere }) {
4 |     const selectFields = {
5 |         id: adapter.tables[tableName].id
                               ^
TypeError: undefined is not an object (evaluating 'adapter.tables[tableName].id')
      at buildQuery (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/queries/buildQuery.js:5:28)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:25:9)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:8:44)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find.js:3:40)
      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/find.js:157:21
      at processTicksAndRejections (native:7:39)

1 | import { buildOrderBy } from './buildOrderBy.js';
2 | import { parseParams } from './parseParams.js';
3 | export const buildQuery = function buildQuery({ adapter, aliasTable, fields, joins = [], locale, parentIsLocalized, selectLocale, sort, tableName, where: incomingWhere }) {
4 |     const selectFields = {
5 |         id: adapter.tables[tableName].id
                               ^
TypeError: undefined is not an object (evaluating 'adapter.tables[tableName].id')
      at buildQuery (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/queries/buildQuery.js:5:28)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:25:9)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:8:44)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find.js:3:40)
      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/find.js:157:21
      at processTicksAndRejections (native:7:39)

1 | import { buildOrderBy } from './buildOrderBy.js';
2 | import { parseParams } from './parseParams.js';
3 | export const buildQuery = function buildQuery({ adapter, aliasTable, fields, joins = [], locale, parentIsLocalized, selectLocale, sort, tableName, where: incomingWhere }) {
4 |     const selectFields = {
5 |         id: adapter.tables[tableName].id
                               ^
TypeError: undefined is not an object (evaluating 'adapter.tables[tableName].id')
      at buildQuery (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/queries/buildQuery.js:5:28)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:25:9)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:8:44)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find.js:3:40)
      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/find.js:157:21
      at processTicksAndRejections (native:7:39)

258 | 
259 | 			const validationState = await tryValidateFirstUserState(validateArgs);
260 | 			const needsFirstUser = await tryCheckFirstUser(checkArgs);
261 | 			const userCount = await tryGetUserCount(countArgs);
262 | 
263 | 			expect(validationState.ok).toBe(true);
                                    ^
error: expect(received).toBe(expected)

Expected: true
Received: false

      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/check-first-user.test.ts:263:31)
(fail) First User Check Functions - With overrideAccess > Integration Tests > tryValidateFirstUserState should match individual function results [0.71ms]
1 | import { buildOrderBy } from './buildOrderBy.js';
2 | import { parseParams } from './parseParams.js';
3 | export const buildQuery = function buildQuery({ adapter, aliasTable, fields, joins = [], locale, parentIsLocalized, selectLocale, sort, tableName, where: incomingWhere }) {
4 |     const selectFields = {
5 |         id: adapter.tables[tableName].id
                               ^
TypeError: undefined is not an object (evaluating 'adapter.tables[tableName].id')
      at buildQuery (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/queries/buildQuery.js:5:28)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:25:9)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:8:44)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find.js:3:40)
      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/find.js:157:21
      at processTicksAndRejections (native:7:39)

315 | 			overrideAccess: true,
316 | 		};
317 | 
318 | 		const adminResult = await tryCreateUser(adminArgs);
319 | 		if (!adminResult.ok) {
320 | 			throw new Error("Failed to create admin user");
                   ^
error: Failed to create admin user
      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/check-first-user.test.ts:320:14)
(fail) First User Check Functions - With Access Control > (unnamed) [2031.11ms]

server/internal/utils/parse-media-from-html.test.ts:
(pass) Parse Media From HTML > should parse media IDs from HTML [3.35ms]
(pass) Parse Media From HTML > should parse media filenames from HTML [0.36ms]
(pass) Parse Media From HTML > should handle mixed ID and filename formats [0.19ms]
(pass) Parse Media From HTML > should return unique media IDs and filenames (no duplicates) [0.29ms]
(pass) Parse Media From HTML > should return empty arrays for HTML without media references [0.33ms]
(pass) Parse Media From HTML > should return empty arrays for empty HTML [0.08ms]
(pass) Parse Media From HTML > should return empty arrays for whitespace-only HTML [0.03ms]
(pass) Parse Media From HTML > should ignore images without src attributes [0.05ms]
(pass) Parse Media From HTML > should ignore images with non-media URLs [0.15ms]
(pass) Parse Media From HTML > should handle URLs with query parameters [0.30ms]
(pass) Parse Media From HTML > should handle URLs with hash fragments [0.05ms]
(pass) Parse Media From HTML > should parse both IDs and filenames regardless of existence [0.12ms]
(pass) Parse Media From HTML > should handle complex HTML with nested elements [0.43ms]

server/internal/utils/gradebook-weight-calculations.test.ts:
(pass) Gradebook Weight Calculations > calculateAdjustedWeights > should calculate adjusted weights for items with specified weights
(pass) Gradebook Weight Calculations > calculateAdjustedWeights > should calculate adjusted weights for items without weights [0.25ms]
(pass) Gradebook Weight Calculations > calculateAdjustedWeights > should calculate adjusted weights for mixed items [0.04ms]
(pass) Gradebook Weight Calculations > calculateAdjustedWeights > should calculate adjusted weights for nested categories [0.30ms]
(pass) Gradebook Weight Calculations > calculateAdjustedWeights > should exclude extra credit items from weight distribution [0.19ms]
(pass) Gradebook Weight Calculations > calculateAdjustedWeights > should distribute remaining weight only among non-extra-credit items [0.07ms]
(pass) Gradebook Weight Calculations > calculateAdjustedWeights > should mark empty auto-weighted category as auto-weighted-0 [0.27ms]
(pass) Gradebook Weight Calculations > calculateAdjustedWeights > should mark category with only extra credit items as auto-weighted-0 [0.06ms]
(pass) Gradebook Weight Calculations > calculateAdjustedWeights > should exclude auto-weighted-0 categories from weight distribution [0.07ms]
(pass) Gradebook Weight Calculations > calculateAdjustedWeights > should mark category with all auto-weighted-0 subcategories as auto-weighted-0 [0.12ms]
(pass) Gradebook Weight Calculations > calculateAdjustedWeights > should not mark category with non-extra-credit items as auto-weighted-0 [0.07ms]
(pass) Gradebook Weight Calculations > calculateOverallWeights > should calculate overall weights for root-level items [0.06ms]
(pass) Gradebook Weight Calculations > calculateOverallWeights > should calculate overall weights for items in categories [0.20ms]
(pass) Gradebook Weight Calculations > calculateOverallWeights > should calculate overall weights for nested categories [0.07ms]
(pass) Gradebook Weight Calculations > calculateOverallWeights > should set overall weight to null for items without adjusted weight [0.08ms]
(pass) Gradebook Weight Calculations > calculateOverallWeights > should not calculate overall weight for categories [0.05ms]
(pass) Gradebook Weight Calculations > calculateOverallWeights > should calculate total overall weight correctly without extra credit [0.06ms]
(pass) Gradebook Weight Calculations > calculateOverallWeights > should calculate total overall weight correctly with extra credit [0.11ms]
(pass) Gradebook Weight Calculations > calculateOverallWeights > should reproduce 101.05% scenario and verify calculation [0.11ms]
(pass) Gradebook Weight Calculations > calculateOverallWeights > should reproduce exact 101.05% scenario with extra credit [0.05ms]
(pass) Gradebook Weight Calculations > calculateOverallWeights > should reproduce 113.8% scenario with extra credit items in categories [0.07ms]
(pass) Gradebook Weight Calculations > calculateOverallWeights > should calculate extra credit total including extra credit categories [0.16ms]

server/internal/utils/validate-gradebook-weights.test.ts:
(pass) validateGradebookWeights > should pass when total weight equals exactly 100% with no auto-weighted items [0.57ms]
(pass) validateGradebookWeights > should fail when total weight does not equal 100% with no auto-weighted items [0.39ms]
(pass) validateGradebookWeights > should pass when specified weights <= 100% with auto-weighted items [0.04ms]
(pass) validateGradebookWeights > should pass when specified weights equal 100% with auto-weighted items [0.03ms]
(pass) validateGradebookWeights > should fail when specified weights exceed 100% with auto-weighted items [0.06ms]
(pass) validateGradebookWeights > should filter out extra credit items from validation [0.06ms]
(pass) validateGradebookWeights > should skip validation when only extra credit items exist [0.04ms]
(pass) validateGradebookWeights > should validate nested categories recursively [0.06ms]
(pass) validateGradebookWeights > should validate multiple nested categories [0.10ms]
(pass) validateGradebookWeights > should handle deeply nested categories [0.06ms]
(pass) validateGradebookWeights > should handle empty items array [0.03ms]
(pass) validateGradebookWeights > should handle items with zero weight
(pass) validateGradebookWeights > should use custom error message prefix [0.02ms]

server/internal/utils/build-gradebook-structure.test.ts:
(pass) Build Gradebook Structure > should not duplicate root-level items when processing root categories [1.31ms]
(pass) Build Gradebook Structure > should include items when processing a specific category [0.05ms]
(pass) Build Gradebook Structure > should handle nested categories correctly [0.09ms]
(pass) Build Gradebook Structure > should include extra_credit field when building structure [0.04ms]

server/internal/utils/validate-script-tag.test.ts:
(pass) Validate Script Tag > should validate valid script tag with src only [3.33ms]
(pass) Validate Script Tag > should validate script tag with defer attribute [0.31ms]
(pass) Validate Script Tag > should validate script tag with async attribute [0.18ms]
(pass) Validate Script Tag > should validate script tag with both defer and async [0.12ms]
(pass) Validate Script Tag > should validate Umami script tag with data-website-id [0.09ms]
(pass) Validate Script Tag > should validate Plausible script tag with data-domain [0.11ms]
(pass) Validate Script Tag > should validate Fathom script tag with data-site [0.19ms]
(pass) Validate Script Tag > should validate Google Analytics script tag [0.10ms]
(pass) Validate Script Tag > should validate script tag with multiple data attributes [0.15ms]
(pass) Validate Script Tag > should reject script tag without src attribute [0.45ms]
(pass) Validate Script Tag > should reject inline script content [0.23ms]
(pass) Validate Script Tag > should reject script tag with onerror attribute [0.22ms]
(pass) Validate Script Tag > should reject script tag with onload attribute [0.18ms]
(pass) Validate Script Tag > should reject script tag with onclick attribute [0.11ms]
(pass) Validate Script Tag > should reject script tag with integrity attribute [0.07ms]
(pass) Validate Script Tag > should reject script tag with crossorigin attribute [0.06ms]
(pass) Validate Script Tag > should reject script tag with non-HTTP/HTTPS URL [0.12ms]
(pass) Validate Script Tag > should reject script tag with file:// URL [0.06ms]
(pass) Validate Script Tag > should reject invalid URL format [0.66ms]
(pass) Validate Script Tag > should reject script tag with unknown attribute [0.13ms]
(pass) Validate Script Tag > should reject empty script tag [0.02ms]
(pass) Validate Script Tag > should reject whitespace-only script tag [0.03ms]
(pass) Validate Script Tag > should reject multiple script tags [0.07ms]
(pass) Validate Script Tag > should reject script tag with no script element [0.11ms]
(pass) Validate Script Tag > should handle HTTP URL (not just HTTPS) [0.10ms]
(pass) Validate Script Tag > should handle script tag with URL containing query parameters [0.09ms]
(pass) Validate Script Tag > should handle script tag with URL containing hash fragment [0.08ms]
(pass) Validate Script Tag > should handle empty data attribute value [0.09ms]
(pass) Validate Script Tag > should handle script tag with whitespace around attributes [0.08ms]

server/internal/gradebook-management.test.ts:
1 | import { buildOrderBy } from './buildOrderBy.js';
2 | import { parseParams } from './parseParams.js';
3 | export const buildQuery = function buildQuery({ adapter, aliasTable, fields, joins = [], locale, parentIsLocalized, selectLocale, sort, tableName, where: incomingWhere }) {
4 |     const selectFields = {
5 |         id: adapter.tables[tableName].id
                               ^
TypeError: undefined is not an object (evaluating 'adapter.tables[tableName].id')
      at buildQuery (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/queries/buildQuery.js:5:28)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:25:9)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:8:44)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find.js:3:40)
      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/find.js:157:21
      at processTicksAndRejections (native:7:39)

50 | 			overrideAccess: true,
51 | 		};
52 | 
53 | 		const instructorResult = await tryCreateUser(instructorArgs);
54 | 
55 | 		expect(instructorResult.ok).toBe(true);
                                   ^
error: expect(received).toBe(expected)

Expected: true
Received: false

      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/gradebook-management.test.ts:55:31)
(fail) Gradebook Management > (unnamed) [1906.10ms]

server/internal/course-activity-module-link-management.test.ts:
1 | import { buildOrderBy } from './buildOrderBy.js';
2 | import { parseParams } from './parseParams.js';
3 | export const buildQuery = function buildQuery({ adapter, aliasTable, fields, joins = [], locale, parentIsLocalized, selectLocale, sort, tableName, where: incomingWhere }) {
4 |     const selectFields = {
5 |         id: adapter.tables[tableName].id
                               ^
TypeError: undefined is not an object (evaluating 'adapter.tables[tableName].id')
      at buildQuery (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/queries/buildQuery.js:5:28)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:25:9)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:8:44)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find.js:3:40)
      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/find.js:157:21
      at processTicksAndRejections (native:7:39)

71 | 			},
72 | 			overrideAccess: true,
73 | 		};
74 | 
75 | 		const userResult = await tryCreateUser(userArgs);
76 | 		expect(userResult.ok).toBe(true);
                             ^
error: expect(received).toBe(expected)

Expected: true
Received: false

      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/course-activity-module-link-management.test.ts:76:25)
(fail) Course Activity Module Link Management Functions > (unnamed) [1891.23ms]

server/internal/quiz-submission-management-time-limit.test.ts:
1 | import { buildOrderBy } from './buildOrderBy.js';
2 | import { parseParams } from './parseParams.js';
3 | export const buildQuery = function buildQuery({ adapter, aliasTable, fields, joins = [], locale, parentIsLocalized, selectLocale, sort, tableName, where: incomingWhere }) {
4 |     const selectFields = {
5 |         id: adapter.tables[tableName].id
                               ^
TypeError: undefined is not an object (evaluating 'adapter.tables[tableName].id')
      at buildQuery (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/queries/buildQuery.js:5:28)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:25:9)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:8:44)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find.js:3:40)
      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/find.js:157:21
      at processTicksAndRejections (native:7:39)

64 | 			overrideAccess: true,
65 | 		};
66 | 
67 | 		const teacherResult = await tryCreateUser(teacherArgs);
68 | 		if (!teacherResult.ok) {
69 | 			throw new Error("Test Error: Failed to create test teacher");
                  ^
error: Test Error: Failed to create test teacher
      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/quiz-submission-management-time-limit.test.ts:69:14)
(fail) Quiz Submission Management - Time Limit > (unnamed) [2027.40ms]

server/internal/appearance-settings.test.ts:
1 | import { buildOrderBy } from './buildOrderBy.js';
2 | import { parseParams } from './parseParams.js';
3 | export const buildQuery = function buildQuery({ adapter, aliasTable, fields, joins = [], locale, parentIsLocalized, selectLocale, sort, tableName, where: incomingWhere }) {
4 |     const selectFields = {
5 |         id: adapter.tables[tableName].id
                               ^
TypeError: undefined is not an object (evaluating 'adapter.tables[tableName].id')
      at buildQuery (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/queries/buildQuery.js:5:28)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:25:9)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:8:44)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find.js:3:40)
      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/find.js:157:21
      at processTicksAndRejections (native:7:39)

42 | 			},
43 | 			overrideAccess: true,
44 | 		});
45 | 
46 | 		if (!userResult.ok) {
47 | 			throw new Error("Failed to create test user");
                  ^
error: Failed to create test user
      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/appearance-settings.test.ts:47:14)
(fail) Appearance Settings Functions > (unnamed) [1867.42ms]

server/internal/enrollment-management.test.ts:
1 | import { buildOrderBy } from './buildOrderBy.js';
2 | import { parseParams } from './parseParams.js';
3 | export const buildQuery = function buildQuery({ adapter, aliasTable, fields, joins = [], locale, parentIsLocalized, selectLocale, sort, tableName, where: incomingWhere }) {
4 |     const selectFields = {
5 |         id: adapter.tables[tableName].id
                               ^
TypeError: undefined is not an object (evaluating 'adapter.tables[tableName].id')
      at buildQuery (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/queries/buildQuery.js:5:28)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:20:53)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:8:44)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find.js:3:40)
      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/find.js:131:39)
(fail) Enrollment Management Functions > (unnamed) [1881.35ms]
1 | import { buildOrderBy } from './buildOrderBy.js';
2 | import { parseParams } from './parseParams.js';
3 | export const buildQuery = function buildQuery({ adapter, aliasTable, fields, joins = [], locale, parentIsLocalized, selectLocale, sort, tableName, where: incomingWhere }) {
4 |     const selectFields = {
5 |         id: adapter.tables[tableName].id
                               ^
TypeError: undefined is not an object (evaluating 'adapter.tables[tableName].id')
      at buildQuery (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/queries/buildQuery.js:5:28)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:20:53)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:8:44)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find.js:3:40)
      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/find.js:131:39)
(fail) Enrollment Management Functions with Authentication > (unnamed) [1997.41ms]

server/internal/activity-module-management.test.ts:
1 | import { buildOrderBy } from './buildOrderBy.js';
2 | import { parseParams } from './parseParams.js';
3 | export const buildQuery = function buildQuery({ adapter, aliasTable, fields, joins = [], locale, parentIsLocalized, selectLocale, sort, tableName, where: incomingWhere }) {
4 |     const selectFields = {
5 |         id: adapter.tables[tableName].id
                               ^
TypeError: undefined is not an object (evaluating 'adapter.tables[tableName].id')
      at buildQuery (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/queries/buildQuery.js:5:28)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:25:9)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:8:44)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find.js:3:40)
      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/find.js:157:21
      at processTicksAndRejections (native:7:39)

80 | 			overrideAccess: true,
81 | 		};
82 | 
83 | 		const userResult = await tryCreateUser(userArgs);
84 | 
85 | 		expect(userResult.ok).toBe(true);
                             ^
error: expect(received).toBe(expected)

Expected: true
Received: false

      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/activity-module-management.test.ts:85:25)
(fail) Activity Module Management > (unnamed) [2001.40ms]

server/internal/discussion-management.test.ts:
1 | import { buildOrderBy } from './buildOrderBy.js';
2 | import { parseParams } from './parseParams.js';
3 | export const buildQuery = function buildQuery({ adapter, aliasTable, fields, joins = [], locale, parentIsLocalized, selectLocale, sort, tableName, where: incomingWhere }) {
4 |     const selectFields = {
5 |         id: adapter.tables[tableName].id
                               ^
TypeError: undefined is not an object (evaluating 'adapter.tables[tableName].id')
      at buildQuery (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/queries/buildQuery.js:5:28)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:25:9)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:8:44)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find.js:3:40)
      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/find.js:157:21
      at processTicksAndRejections (native:7:39)

76 | 			},
77 | 			overrideAccess: true,
78 | 		};
79 | 
80 | 		const teacherResult = await tryCreateUser(teacherArgs);
81 | 		expect(teacherResult.ok).toBe(true);
                                ^
error: expect(received).toBe(expected)

Expected: true
Received: false

      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/discussion-management.test.ts:81:28)
(fail) Discussion Management - Full Workflow > (unnamed) [2752.79ms]

server/internal/scheduled-tasks-management.test.ts:
1 | import { fieldShouldBeLocalized } from 'payload/shared';
2 | import { isArrayOfRows } from '../../utilities/isArrayOfRows.js';
3 | import { traverseFields } from './traverseFields.js';
4 | export const transformArray = ({ adapter, arrayTableName, baseTableName, blocks, blocksToDelete, data, field, locale, numbers, numbersToDelete, parentIsLocalized, path, relationships, relationshipsToDelete, selects, texts, textsToDelete, withinArrayOrBlockLocale })=>{
5 |     const newRows = [];
6 |     const hasUUID = adapter.tables[arrayTableName]._uuid;
                                       ^
TypeError: undefined is not an object (evaluating 'adapter.tables[arrayTableName]._uuid')
      at transformArray (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/transform/write/array.js:6:36)
      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/transform/write/traverseFields.js:97:33)
      at forEach (1:11)
      at traverseFields (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/transform/write/traverseFields.js:18:12)
      at transformForWrite (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/transform/write/index.js:22:5)
      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/upsertRow/index.js:130:25)
      at upsertRow (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/upsertRow/index.js:16:30)
      at create (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/create.js:8:26)
      at async <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/queues/localAPI.js:71:43)
      at async <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/scheduled-tasks-management.test.ts:41:22)
(fail) Scheduled Tasks Management > should correctly identify pending status for future scheduled task [1.21ms]
1 | import { fieldShouldBeLocalized } from 'payload/shared';
2 | import { isArrayOfRows } from '../../utilities/isArrayOfRows.js';
3 | import { traverseFields } from './traverseFields.js';
4 | export const transformArray = ({ adapter, arrayTableName, baseTableName, blocks, blocksToDelete, data, field, locale, numbers, numbersToDelete, parentIsLocalized, path, relationships, relationshipsToDelete, selects, texts, textsToDelete, withinArrayOrBlockLocale })=>{
5 |     const newRows = [];
6 |     const hasUUID = adapter.tables[arrayTableName]._uuid;
                                       ^
TypeError: undefined is not an object (evaluating 'adapter.tables[arrayTableName]._uuid')
      at transformArray (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/transform/write/array.js:6:36)
      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/transform/write/traverseFields.js:97:33)
      at forEach (1:11)
      at traverseFields (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/transform/write/traverseFields.js:18:12)
      at transformForWrite (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/transform/write/index.js:22:5)
      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/upsertRow/index.js:130:25)
      at upsertRow (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/upsertRow/index.js:16:30)
      at create (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/create.js:8:26)
      at async <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/queues/localAPI.js:71:43)
      at async <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/scheduled-tasks-management.test.ts:86:22)
(fail) Scheduled Tasks Management > should correctly identify expired status for past scheduled task [0.28ms]
1 | import { fieldShouldBeLocalized } from 'payload/shared';
2 | import { isArrayOfRows } from '../../utilities/isArrayOfRows.js';
3 | import { traverseFields } from './traverseFields.js';
4 | export const transformArray = ({ adapter, arrayTableName, baseTableName, blocks, blocksToDelete, data, field, locale, numbers, numbersToDelete, parentIsLocalized, path, relationships, relationshipsToDelete, selects, texts, textsToDelete, withinArrayOrBlockLocale })=>{
5 |     const newRows = [];
6 |     const hasUUID = adapter.tables[arrayTableName]._uuid;
                                       ^
TypeError: undefined is not an object (evaluating 'adapter.tables[arrayTableName]._uuid')
      at transformArray (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/transform/write/array.js:6:36)
      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/transform/write/traverseFields.js:97:33)
      at forEach (1:11)
      at traverseFields (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/transform/write/traverseFields.js:18:12)
      at transformForWrite (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/transform/write/index.js:22:5)
      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/upsertRow/index.js:130:25)
      at upsertRow (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/upsertRow/index.js:16:30)
      at create (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/create.js:8:26)
      at async <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/queues/localAPI.js:71:43)
      at async <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/scheduled-tasks-management.test.ts:134:34)
(fail) Scheduled Tasks Management > should correctly identify completed status for finished task [0.15ms]
1 | import { fieldShouldBeLocalized } from 'payload/shared';
2 | import { isArrayOfRows } from '../../utilities/isArrayOfRows.js';
3 | import { traverseFields } from './traverseFields.js';
4 | export const transformArray = ({ adapter, arrayTableName, baseTableName, blocks, blocksToDelete, data, field, locale, numbers, numbersToDelete, parentIsLocalized, path, relationships, relationshipsToDelete, selects, texts, textsToDelete, withinArrayOrBlockLocale })=>{
5 |     const newRows = [];
6 |     const hasUUID = adapter.tables[arrayTableName]._uuid;
                                       ^
TypeError: undefined is not an object (evaluating 'adapter.tables[arrayTableName]._uuid')
      at transformArray (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/transform/write/array.js:6:36)
      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/transform/write/traverseFields.js:97:33)
      at forEach (1:11)
      at traverseFields (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/transform/write/traverseFields.js:18:12)
      at transformForWrite (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/transform/write/index.js:22:5)
      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/upsertRow/index.js:130:25)
      at upsertRow (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/upsertRow/index.js:16:30)
      at create (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/create.js:8:26)
      at async <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/queues/localAPI.js:71:43)
      at async <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/scheduled-tasks-management.test.ts:182:34)
(fail) Scheduled Tasks Management > should correctly identify failed status for failed task [0.15ms]
1 | import { fieldShouldBeLocalized } from 'payload/shared';
2 | import { isArrayOfRows } from '../../utilities/isArrayOfRows.js';
3 | import { traverseFields } from './traverseFields.js';
4 | export const transformArray = ({ adapter, arrayTableName, baseTableName, blocks, blocksToDelete, data, field, locale, numbers, numbersToDelete, parentIsLocalized, path, relationships, relationshipsToDelete, selects, texts, textsToDelete, withinArrayOrBlockLocale })=>{
5 |     const newRows = [];
6 |     const hasUUID = adapter.tables[arrayTableName]._uuid;
                                       ^
TypeError: undefined is not an object (evaluating 'adapter.tables[arrayTableName]._uuid')
      at transformArray (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/transform/write/array.js:6:36)
      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/transform/write/traverseFields.js:97:33)
      at forEach (1:11)
      at traverseFields (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/transform/write/traverseFields.js:18:12)
      at transformForWrite (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/transform/write/index.js:22:5)
      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/upsertRow/index.js:130:25)
      at upsertRow (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/upsertRow/index.js:16:30)
      at create (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/create.js:8:26)
      at async <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/queues/localAPI.js:71:43)
      at async <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/scheduled-tasks-management.test.ts:232:34)
(fail) Scheduled Tasks Management > should correctly identify processing status for task being processed [0.13ms]
1 | import { fieldShouldBeLocalized } from 'payload/shared';
2 | import { isArrayOfRows } from '../../utilities/isArrayOfRows.js';
3 | import { traverseFields } from './traverseFields.js';
4 | export const transformArray = ({ adapter, arrayTableName, baseTableName, blocks, blocksToDelete, data, field, locale, numbers, numbersToDelete, parentIsLocalized, path, relationships, relationshipsToDelete, selects, texts, textsToDelete, withinArrayOrBlockLocale })=>{
5 |     const newRows = [];
6 |     const hasUUID = adapter.tables[arrayTableName]._uuid;
                                       ^
TypeError: undefined is not an object (evaluating 'adapter.tables[arrayTableName]._uuid')
      at transformArray (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/transform/write/array.js:6:36)
      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/transform/write/traverseFields.js:97:33)
      at forEach (1:11)
      at traverseFields (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/transform/write/traverseFields.js:18:12)
      at transformForWrite (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/transform/write/index.js:22:5)
      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/upsertRow/index.js:130:25)
      at upsertRow (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/upsertRow/index.js:16:30)
      at create (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/create.js:8:26)
      at async <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/queues/localAPI.js:71:43)
      at async <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/scheduled-tasks-management.test.ts:280:22)
(fail) Scheduled Tasks Management > should calculate statistics correctly [0.16ms]

server/internal/note-management.test.ts:
1 | import { buildOrderBy } from './buildOrderBy.js';
2 | import { parseParams } from './parseParams.js';
3 | export const buildQuery = function buildQuery({ adapter, aliasTable, fields, joins = [], locale, parentIsLocalized, selectLocale, sort, tableName, where: incomingWhere }) {
4 |     const selectFields = {
5 |         id: adapter.tables[tableName].id
                               ^
TypeError: undefined is not an object (evaluating 'adapter.tables[tableName].id')
      at buildQuery (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/queries/buildQuery.js:5:28)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:25:9)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:8:44)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find.js:3:40)
      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/find.js:157:21
      at processTicksAndRejections (native:7:39)

1 | import { buildOrderBy } from './buildOrderBy.js';
2 | import { parseParams } from './parseParams.js';
3 | export const buildQuery = function buildQuery({ adapter, aliasTable, fields, joins = [], locale, parentIsLocalized, selectLocale, sort, tableName, where: incomingWhere }) {
4 |     const selectFields = {
5 |         id: adapter.tables[tableName].id
                               ^
TypeError: undefined is not an object (evaluating 'adapter.tables[tableName].id')
      at buildQuery (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/queries/buildQuery.js:5:28)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:25:9)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:8:44)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find.js:3:40)
      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/find.js:157:21
      at processTicksAndRejections (native:7:39)

1 | import { buildOrderBy } from './buildOrderBy.js';
2 | import { parseParams } from './parseParams.js';
3 | export const buildQuery = function buildQuery({ adapter, aliasTable, fields, joins = [], locale, parentIsLocalized, selectLocale, sort, tableName, where: incomingWhere }) {
4 |     const selectFields = {
5 |         id: adapter.tables[tableName].id
                               ^
TypeError: undefined is not an object (evaluating 'adapter.tables[tableName].id')
      at buildQuery (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/queries/buildQuery.js:5:28)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:25:9)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:8:44)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find.js:3:40)
      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/find.js:157:21
      at processTicksAndRejections (native:7:39)

88 | 		const userResult1 = await tryCreateUser(userArgs1);
89 | 		const userResult2 = await tryCreateUser(userArgs2);
90 | 		const adminResult = await tryCreateUser(adminArgs);
91 | 
92 | 		if (!userResult1.ok || !userResult2.ok || !adminResult.ok) {
93 | 			throw new Error("Failed to create test users");
                  ^
error: Failed to create test users
      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/note-management.test.ts:93:14)
(fail) Note Management Functions > (unnamed) [1921.82ms]

server/internal/user-grade-management.test.ts:
1 | import { buildOrderBy } from './buildOrderBy.js';
2 | import { parseParams } from './parseParams.js';
3 | export const buildQuery = function buildQuery({ adapter, aliasTable, fields, joins = [], locale, parentIsLocalized, selectLocale, sort, tableName, where: incomingWhere }) {
4 |     const selectFields = {
5 |         id: adapter.tables[tableName].id
                               ^
TypeError: undefined is not an object (evaluating 'adapter.tables[tableName].id')
      at buildQuery (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/queries/buildQuery.js:5:28)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:25:9)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:8:44)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find.js:3:40)
      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/find.js:157:21
      at processTicksAndRejections (native:7:39)

1 | import { buildOrderBy } from './buildOrderBy.js';
2 | import { parseParams } from './parseParams.js';
3 | export const buildQuery = function buildQuery({ adapter, aliasTable, fields, joins = [], locale, parentIsLocalized, selectLocale, sort, tableName, where: incomingWhere }) {
4 |     const selectFields = {
5 |         id: adapter.tables[tableName].id
                               ^
TypeError: undefined is not an object (evaluating 'adapter.tables[tableName].id')
      at buildQuery (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/queries/buildQuery.js:5:28)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:25:9)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:8:44)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find.js:3:40)
      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/find.js:157:21
      at processTicksAndRejections (native:7:39)

1 | import { buildOrderBy } from './buildOrderBy.js';
2 | import { parseParams } from './parseParams.js';
3 | export const buildQuery = function buildQuery({ adapter, aliasTable, fields, joins = [], locale, parentIsLocalized, selectLocale, sort, tableName, where: incomingWhere }) {
4 |     const selectFields = {
5 |         id: adapter.tables[tableName].id
                               ^
TypeError: undefined is not an object (evaluating 'adapter.tables[tableName].id')
      at buildQuery (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/queries/buildQuery.js:5:28)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:25:9)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:8:44)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find.js:3:40)
      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/find.js:157:21
      at processTicksAndRejections (native:7:39)

114 | 
115 | 		const adminResult = await tryCreateUser(adminArgs);
116 | 		const instructorResult = await tryCreateUser(instructorArgs);
117 | 		const studentResult = await tryCreateUser(studentArgs);
118 | 
119 | 		expect(adminResult.ok).toBe(true);
                               ^
error: expect(received).toBe(expected)

Expected: true
Received: false

      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/user-grade-management.test.ts:119:26)
(fail) User Grade Management > (unnamed) [1945.21ms]

server/internal/gradebook-item-management.test.ts:
1 | import { buildOrderBy } from './buildOrderBy.js';
2 | import { parseParams } from './parseParams.js';
3 | export const buildQuery = function buildQuery({ adapter, aliasTable, fields, joins = [], locale, parentIsLocalized, selectLocale, sort, tableName, where: incomingWhere }) {
4 |     const selectFields = {
5 |         id: adapter.tables[tableName].id
                               ^
TypeError: undefined is not an object (evaluating 'adapter.tables[tableName].id')
      at buildQuery (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/queries/buildQuery.js:5:28)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:25:9)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:8:44)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find.js:3:40)
      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/find.js:157:21
      at processTicksAndRejections (native:7:39)

1 | import { buildOrderBy } from './buildOrderBy.js';
2 | import { parseParams } from './parseParams.js';
3 | export const buildQuery = function buildQuery({ adapter, aliasTable, fields, joins = [], locale, parentIsLocalized, selectLocale, sort, tableName, where: incomingWhere }) {
4 |     const selectFields = {
5 |         id: adapter.tables[tableName].id
                               ^
TypeError: undefined is not an object (evaluating 'adapter.tables[tableName].id')
      at buildQuery (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/queries/buildQuery.js:5:28)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:25:9)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:8:44)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find.js:3:40)
      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/find.js:157:21
      at processTicksAndRejections (native:7:39)

78 | 		};
79 | 
80 | 		const instructorResult = await tryCreateUser(instructorArgs);
81 | 		const studentResult = await tryCreateUser(studentArgs);
82 | 
83 | 		expect(instructorResult.ok).toBe(true);
                                   ^
error: expect(received).toBe(expected)

Expected: true
Received: false

      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/internal/gradebook-item-management.test.ts:83:31)
(fail) Gradebook Item Management > (unnamed) [1920.42ms]

server/utils/course-structure-tree.test.ts:
(pass) Course Structure Tree Generation > should generate detailed tree with order information [0.69ms]
(pass) Course Structure Tree Generation > should generate simple tree without order information [0.10ms]
(pass) Course Structure Tree Generation > should handle empty course structure [0.13ms]
(pass) Course Structure Tree Generation > should handle sections with no content [0.02ms]
(pass) Course Structure Tree Generation > should handle deeply nested structure [0.39ms]
(pass) Course Structure Tree Generation > should handle mixed content order correctly [0.13ms]

server/utils/db/seed.test.ts:
1 | import { buildOrderBy } from './buildOrderBy.js';
2 | import { parseParams } from './parseParams.js';
3 | export const buildQuery = function buildQuery({ adapter, aliasTable, fields, joins = [], locale, parentIsLocalized, selectLocale, sort, tableName, where: incomingWhere }) {
4 |     const selectFields = {
5 |         id: adapter.tables[tableName].id
                               ^
TypeError: undefined is not an object (evaluating 'adapter.tables[tableName].id')
      at buildQuery (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/queries/buildQuery.js:5:28)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:25:9)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find/findMany.js:8:44)
      at find (/Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/@payloadcms/drizzle/dist/find.js:3:40)
      at /Users/yomaruhananoshika/repos/@paideia/paideia/node_modules/payload/dist/collections/operations/find.js:157:21
      at processTicksAndRejections (native:7:39)

83 | function assertResultOk<T>(
84 | 	result: Result<T, Error>,
85 | 	errorMessage: string,
86 | ): asserts result is Result<T, Error> & { ok: true; value: T } {
87 | 	if (!result.ok) {
88 | 		throw new Error(`${errorMessage}: ${result.error.message}`);
                 ^
error: Failed to check first user: Failed to check if first user exists
      at assertResultOk (/Users/yomaruhananoshika/repos/@paideia/paideia/server/utils/db/seed.ts:88:13)
      at /Users/yomaruhananoshika/repos/@paideia/paideia/server/utils/db/seed.ts:611:3
      at processTicksAndRejections (native:7:39)

31 | 		}
32 | 	});
33 | 
34 | 	test("should successfully seed database without errors", async () => {
35 | 		const result = await tryRunSeed({ payload });
36 | 		expect(result.ok).toBe(true);
                         ^
error: expect(received).toBe(expected)

Expected: true
Received: false

      at <anonymous> (/Users/yomaruhananoshika/repos/@paideia/paideia/server/utils/db/seed.test.ts:36:21)
(fail) Database Seeding > should successfully seed database without errors [2.68ms]

server/json/raw-quiz-config/version-resolver.test.ts:
(pass) raw-quiz-config-version-resolver > should convert v1 regular quiz to v2 with correct discriminated union [0.34ms]
(pass) raw-quiz-config-version-resolver > should convert v1 container quiz to v2 and move resources to nested quizzes [0.08ms]
(pass) raw-quiz-config-version-resolver > should pass through v2 config unchanged [0.38ms]
(pass) raw-quiz-config-version-resolver > should validate quiz configs correctly [0.04ms]
(pass) raw-quiz-config-version-resolver > should safely handle invalid input with try function [0.10ms]
(pass) raw-quiz-config-version-resolver > should convert v1 fill-in-the-blank questions to v2 format [0.26ms]
(pass) raw-quiz-config-version-resolver > should pass through v2 fill-in-the-blank with new blank_id format [0.11ms]

58 tests failed:
(fail) Category Role Management Functions > should prevent duplicate assignments (one role per user per category) [40.14ms]
(fail) Category Role Management Functions > should get all role assignments for a user [35.03ms]
(fail) Category Role Management Functions > should get all role assignments for a category [26.34ms]
(fail) Category Role Management Functions > should find specific role assignment [19.89ms]
(fail) Category Role Management Functions > should check if user has role on category [20.54ms]
(fail) Category Role Management Functions > should get effective role with inheritance from parent category [23.64ms]
(fail) Category Role Management Functions > should respect role priority (admin > coordinator > reviewer) [38.08ms]
(fail) Category Role Management Functions > should get all courses user can access via category roles [66.05ms]
(fail) Category Role Management Functions > should check course access via direct category [49.29ms]
(fail) Category Role Management Functions > should check course access via ancestor category [43.20ms]
(fail) Quiz Attempt Management - Prevent Duplicate Attempts > (unnamed) [2272.91ms]
(fail) File Management Functions > should update a file media [32.10ms]
(fail) Page Management Functions > should update page media array when content changes [18.30ms]
(fail) Course Management Functions > tryGetUserAccessibleCourses - Access Control Tests > should only return courses user owns or is enrolled in with overrideAccess false [8.34ms]
(fail) Quiz Management - Full Workflow > should create quiz (teacher workflow) [3.47ms]
(fail) Quiz Management - Full Workflow > should create quiz submission (student workflow) [48.29ms]
(fail) Quiz Management - Full Workflow > should update quiz submission (student editing answers) [10.02ms]
(fail) Quiz Management - Full Workflow > should submit quiz (student submits for grading) [6.89ms]
(fail) Quiz Management - Full Workflow > should calculate quiz grade automatically [9.49ms]
(fail) Quiz Management - Full Workflow > should get quiz submission by ID [17.39ms]
(fail) Quiz Management - Full Workflow > should list quiz submissions with filtering [4.56ms]
(fail) Quiz Management - Full Workflow > should handle late submissions [15.31ms]
(fail) Quiz Management - Full Workflow > should prevent duplicate submissions for same attempt [17.76ms]
(fail) Quiz Management - Full Workflow > should only allow grading of completed quizzes [16.79ms]
(fail) Quiz Management - Full Workflow > should delete quiz submission [20.80ms]
(fail) Quiz Management - Full Workflow > should handle pagination in listing [22.12ms]
(fail) Quiz Management - Full Workflow > should store and retrieve rawQuizConfig [1.81ms]
(fail) Quiz Management - Full Workflow > should reject submission after time limit exceeded [1.24ms]
(fail) Quiz Management - Full Workflow > should auto-submit quiz when timer expires [1.21ms]
(fail) Quiz Attempt Management - Start and Retrieve > (unnamed) [3104.40ms]
(fail) First User Check Functions - With overrideAccess > tryCheckFirstUser > should return true when no users exist [5001.07ms]
  ^ this test timed out after 5000ms.
(fail) First User Check Functions - With overrideAccess > tryCheckFirstUser > should return false when users exist [4.83ms]
(fail) First User Check Functions - With overrideAccess > tryGetUserCount > should return correct user count [0.82ms]
(fail) First User Check Functions - With overrideAccess > tryGetUserCount > should return 0 when no users exist [5000.46ms]
  ^ this test timed out after 5000ms.
(fail) First User Check Functions - With overrideAccess > tryValidateFirstUserState > should return valid state with correct structure [2.94ms]
(fail) First User Check Functions - With overrideAccess > tryValidateFirstUserState > should return isValid=true when database is accessible [0.37ms]
(fail) First User Check Functions - With overrideAccess > tryValidateFirstUserState > should return userCount matching actual database state [26.45ms]
(fail) First User Check Functions - With overrideAccess > Integration Tests > tryCheckFirstUser and tryGetUserCount should be consistent [0.64ms]
(fail) First User Check Functions - With overrideAccess > Integration Tests > tryValidateFirstUserState should match individual function results [0.71ms]
(fail) First User Check Functions - With Access Control > (unnamed) [2031.11ms]
(fail) Gradebook Management > (unnamed) [1906.10ms]
(fail) Course Activity Module Link Management Functions > (unnamed) [1891.23ms]
(fail) Quiz Submission Management - Time Limit > (unnamed) [2027.40ms]
(fail) Appearance Settings Functions > (unnamed) [1867.42ms]
(fail) Enrollment Management Functions > (unnamed) [1881.35ms]
(fail) Enrollment Management Functions with Authentication > (unnamed) [1997.41ms]
(fail) Activity Module Management > (unnamed) [2001.40ms]
(fail) Discussion Management - Full Workflow > (unnamed) [2752.79ms]
(fail) Scheduled Tasks Management > should correctly identify pending status for future scheduled task [1.21ms]
(fail) Scheduled Tasks Management > should correctly identify expired status for past scheduled task [0.28ms]
(fail) Scheduled Tasks Management > should correctly identify completed status for finished task [0.15ms]
(fail) Scheduled Tasks Management > should correctly identify failed status for failed task [0.15ms]
(fail) Scheduled Tasks Management > should correctly identify processing status for task being processed [0.13ms]
(fail) Scheduled Tasks Management > should calculate statistics correctly [0.16ms]
(fail) Note Management Functions > (unnamed) [1921.82ms]
(fail) User Grade Management > (unnamed) [1945.21ms]
(fail) Gradebook Item Management > (unnamed) [1920.42ms]
(fail) Database Seeding > should successfully seed database without errors [2.68ms]

 384 pass
 58 fail
 2 errors
 1751 expect() calls
Ran 442 tests across 40 files. [172.34s]


============================================================
Test Verification Summary
============================================================

 False alarms (9):
  - server/internal/appearance-settings.test.ts
  - server/internal/check-first-user.test.ts
  - server/internal/course-activity-module-link-management.test.ts
  - server/internal/enrollment-management.test.ts
  - server/internal/gradebook-management.test.ts
  - server/internal/note-management.test.ts
  - server/internal/scheduled-tasks-management.test.ts
  - server/json/raw-quiz-config/version-resolver.test.ts
  - server/utils/db/seed.test.ts

 Real failures (12):
  - server/internal/activity-module-management.test.ts
  - server/internal/category-role-management.test.ts
  - server/internal/course-management.test.ts
  - server/internal/discussion-management.test.ts
  - server/internal/file-management.test.ts
  - server/internal/gradebook-item-management.test.ts
  - server/internal/page-management.test.ts
  - server/internal/quiz-submission-management-attempt-start-retrieve.test.ts
  - server/internal/quiz-submission-management-full-workflow.test.ts
  - server/internal/quiz-submission-management-prevent-duplicate-attempts.test.ts
  - server/internal/quiz-submission-management-time-limit.test.ts
  - server/internal/user-grade-management.test.ts
