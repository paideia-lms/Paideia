# Release Notes - Paideia LMS v0.7.13

**Release Date:** January 10, 2026  
**Version:** 0.7.13  
**Type**: Critical Bug Fix  
**Impact**: High - Fixes critical issue preventing sandbox database reset from working correctly  
**Changelog**: N/A

## Overview

Paideia LMS v0.7.13 is a critical bug fix release that resolves a critical issue with the sandbox database reset functionality introduced in v0.7.12. This release fixes a bug that prevented the first user from being registered during the sandbox reset process, causing the entire reset operation to fail. Users are **strongly urged** to upgrade to v0.7.13 immediately if they are using sandbox mode.

---

## Critical Bug Fix

### üîß Sandbox Reset First User Registration

**Bug Fix**: Fixed sandbox database reset failing to register the first user, causing the entire reset process to fail with "Failed to register first user" error.

**What Was Wrong**:
- Sandbox reset was failing during the seed process when attempting to register the first admin user
- The `tryRegisterFirstUser` function was missing the `req` parameter in the user existence check
- This caused the function to fail when checking if users already exist in the system
- Sandbox reset would fail with error: "Failed to register first user. There can be bugs with this version. Please turn off sandbox mode and try the normal mode."
- Database would remain in an inconsistent state after failed reset

**What Changed**:
- Added missing `req` parameter to `payload.find` call in `tryRegisterFirstUser` function
- User existence check now properly uses the transaction context
- First user registration now works correctly during sandbox reset
- Sandbox reset process completes successfully and seeds fresh data

**Technical Details**:
- Fixed `tryRegisterFirstUser` to pass `req` parameter to `payload.find` when checking for existing users
- Ensures the user existence check runs within the proper request context
- First user registration now completes successfully within the transaction

**Impact**:
- ‚úÖ Sandbox mode now correctly resets and seeds database on startup
- ‚úÖ First admin user is properly created during seed process
- ‚úÖ Sandbox reset completes successfully without errors
- ‚úÖ Sandbox environment works as intended

**Error Message Before Fix**:
```
‚ö†Ô∏è  seed.json not found in project root, using predefined test data
üå± Checking if database needs seeding...
üå± Database is fresh, starting seed process...

üì¶ Creating Users
üë§ Creating admin user...
‚ùå Failed to reset sandbox database: Failed to register first user. There can be bugs with this version. Please turn off sandbox mode and try the normal mode.
```

---

## Summary

This release fixes a critical bug that prevented sandbox database reset from working correctly:

### Bug Fixes
- ‚úÖ Sandbox reset now correctly registers the first admin user
- ‚úÖ Seed process completes successfully after database reset
- ‚úÖ Request context properly passed to user existence check
- ‚úÖ Sandbox environment fully functional

---

## Breaking Changes

### None

This release maintains full backward compatibility:
- ‚úÖ All existing functionality works exactly as before
- ‚úÖ No API changes
- ‚úÖ No configuration changes required
- ‚úÖ No database migrations needed
- ‚úÖ No user-facing breaking changes

---

## Upgrade Instructions

### ‚ö†Ô∏è **URGENT: Upgrade Immediately if Using Sandbox Mode**

If you are using sandbox mode, you **must** upgrade to v0.7.13 immediately. The bug in v0.7.12 prevents sandbox reset from working correctly, which can cause the application to fail on startup.

### From v0.7.12

1. **Upgrade to v0.7.13**:
   ```bash
   git pull origin next  # or your branch
   ```

2. **Install dependencies**:
   ```bash
   bun install
   ```

3. **Start the server**:
   ```bash
   bun run dev
   ```

**No Additional Steps Required**:
- No database migrations needed
- No configuration changes required
- No manual data migration needed
- Everything works automatically after upgrade

**For Sandbox Mode Users**:
- After upgrading, the sandbox reset will work correctly
- The first admin user will be created successfully
- Database will be properly seeded with fresh data
- No manual intervention required

---

## What's Next

This release ensures sandbox mode works correctly for development and testing:
- **Reliable Sandbox Reset**: Database reset now works as expected
- **Proper Seed Process**: First user registration completes successfully
- **Stable Development Environment**: Sandbox mode is fully functional
- **Continued Improvements**: Ongoing enhancements to sandbox functionality

The fix in this release makes sandbox mode reliable for development and testing, ensuring that developers can reset their database and start with fresh seed data without issues.

---

## Thank You

Thank you for using Paideia LMS. This release fixes a critical bug that affected sandbox mode functionality. We strongly recommend upgrading to v0.7.13 immediately if you are using sandbox mode, as v0.7.12 has a bug that prevents the sandbox reset from working correctly.

For questions, issues, or contributions, please visit our GitHub repository: https://github.com/paideia-lms/paideia

---

## Complete Changelog Reference

This release includes the following improvements:

### Bug Fixes
- **Sandbox Reset First User Registration**: Fixed missing `req` parameter in `tryRegisterFirstUser` function
- **User Existence Check**: Fixed user existence check to use proper request context
- **Sandbox Reset Completion**: Sandbox reset now completes successfully

**Previous Release**: See [v0.7.12 Release Notes](./0.7.12-2026-01-10.md) for previous features.
